<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="10">
  <HTTPTask id="534" hostname="learning2.pflb.ru:56902" path="/director/catalog/catalog.js" url="http://learning2.pflb.ru:56902/director/catalog/catalog.js" ip="94.159.69.182" port="56902" connectionId="46" origin="Primary" frame="1" startDateTime="2020-02-22T14:38:48.202+04:00" startTime="2968453" endTime="2968484">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Host" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bGVhcm5pbmcyLnBmbGIucnU6NTY5MDI=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ki8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Requested-With" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>WE1MSHR0cFJlcXVlc3Q=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzc5LjAuMzk0NS4xMzAgU2FmYXJpLzUzNy4zNiBPUFIvNjYuMC4zNTE1LjEwMw==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cDovL2xlYXJuaW5nMi5wZmxiLnJ1OjU2OTAyLw==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tVVMsZW47cT0wLjkscnUtUlU7cT0wLjgscnU7cT0wLjc=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Y3VycmVudENvbXBhbnk9MDsgY3VycmVudFVzZXI9ZGlyZWN0b3I7IHNlc3Npb25FeHBpcmVkPWZhbHNlOyBTRVNTSU9OPTM5ZmE4N2M5LTcwNjQtNDcyOC1hZDBjLWM1M2E5YzhmMGJiYTsgUEZMQi5wcmUubG9naW4ubGluaz1udWxsOyBmaWx0ZXJTZXR0aW5nPSU3QiUyMnBhZ2UlMjIlM0ElMjJodHRwJTNBJTJGJTJGbGVhcm5pbmcyLnBmbGIucnUlM0E1NjkwMiUyRiUyM3RpY2tldHMlM0ZzdGF0ZSUzRG9wZW5lZCUyNnBhZ2UlM0QxJTIyJTJDJTIyc21obyUyMiUzQW51bGwlMkMlMjJkYXRlU3RhcnQlMjIlM0ElMjIlMjIlMkMlMjJkYXRlRW5kJTIyJTNBJTIyJTIyJTJDJTIyY2F0MSUyMiUzQW51bGwlMkMlMjJjYXQyJTIyJTNBbnVsbCUyQyUyMmNhdDMlMjIlM0FudWxsJTJDJTIyY2F0NCUyMiUzQW51bGwlMkMlMjJ0aGVtZSUyMiUzQW51bGwlMkMlMjJvdmVyZHVlJTIyJTNBZmFsc2UlMkMlMjJmaWx0ZXJzJTIyJTNBJTdCJTIybmV3Q2hlY2tib3glMjIlM0F0cnVlJTJDJTIyYXBwb2ludGVkQ2hlY2tib3glMjIlM0F0cnVlJTJDJTIycGVyZm9ybWVkQ2hlY2tib3glMjIlM0F0cnVlJTJDJTIyY29udHJvbENoZWNrYm94JTIyJTNBdHJ1ZSU3RCU3RA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="dnt" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC9kaXJlY3Rvci9jYXRhbG9nL2NhdGFsb2cuanMgSFRUUC8xLjENCkhvc3Q6IGxlYXJuaW5nMi5wZmxiLnJ1OjU2OTAyDQpDb25uZWN0aW9uOiBrZWVwLWFsaXZlDQpBY2NlcHQ6ICovKg0KWC1SZXF1ZXN0ZWQtV2l0aDogWE1MSHR0cFJlcXVlc3QNClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS83OS4wLjM5NDUuMTMwIFNhZmFyaS81MzcuMzYgT1BSLzY2LjAuMzUxNS4xMDMNClJlZmVyZXI6IGh0dHA6Ly9sZWFybmluZzIucGZsYi5ydTo1NjkwMi8NCkFjY2VwdC1FbmNvZGluZzogZ3ppcCwgZGVmbGF0ZQ0KQWNjZXB0LUxhbmd1YWdlOiBlbi1VUyxlbjtxPTAuOSxydS1SVTtxPTAuOCxydTtxPTAuNw0KQ29va2llOiBjdXJyZW50Q29tcGFueT0wOyBjdXJyZW50VXNlcj1kaXJlY3Rvcjsgc2Vzc2lvbkV4cGlyZWQ9ZmFsc2U7IFNFU1NJT049MzlmYTg3YzktNzA2NC00NzI4LWFkMGMtYzUzYTljOGYwYmJhOyBQRkxCLnByZS5sb2dpbi5saW5rPW51bGw7IGZpbHRlclNldHRpbmc9JTdCJTIycGFnZSUyMiUzQSUyMmh0dHAlM0ElMkYlMkZsZWFybmluZzIucGZsYi5ydSUzQTU2OTAyJTJGJTIzdGlja2V0cyUzRnN0YXRlJTNEb3BlbmVkJTI2cGFnZSUzRDElMjIlMkMlMjJzbWhvJTIyJTNBbnVsbCUyQyUyMmRhdGVTdGFydCUyMiUzQSUyMiUyMiUyQyUyMmRhdGVFbmQlMjIlM0ElMjIlMjIlMkMlMjJjYXQxJTIyJTNBbnVsbCUyQyUyMmNhdDIlMjIlM0FudWxsJTJDJTIyY2F0MyUyMiUzQW51bGwlMkMlMjJjYXQ0JTIyJTNBbnVsbCUyQyUyMnRoZW1lJTIyJTNBbnVsbCUyQyUyMm92ZXJkdWUlMjIlM0FmYWxzZSUyQyUyMmZpbHRlcnMlMjIlM0ElN0IlMjJuZXdDaGVja2JveCUyMiUzQXRydWUlMkMlMjJhcHBvaW50ZWRDaGVja2JveCUyMiUzQXRydWUlMkMlMjJwZXJmb3JtZWRDaGVja2JveCUyMiUzQXRydWUlMkMlMjJjb250cm9sQ2hlY2tib3glMjIlM0F0cnVlJTdEJTdEDQpkbnQ6IDENCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="currentCompany" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="currentUser" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZGlyZWN0b3I=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="sessionExpired" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZmFsc2U=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="SESSION" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MzlmYTg3YzktNzA2NC00NzI4LWFkMGMtYzUzYTljOGYwYmJh</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="PFLB.pre.login.link" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>bnVsbA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="filterSetting" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>JTdCJTIycGFnZSUyMiUzQSUyMmh0dHAlM0ElMkYlMkZsZWFybmluZzIucGZsYi5ydSUzQTU2OTAyJTJGJTIzdGlja2V0cyUzRnN0YXRlJTNEb3BlbmVkJTI2cGFnZSUzRDElMjIlMkMlMjJzbWhvJTIyJTNBbnVsbCUyQyUyMmRhdGVTdGFydCUyMiUzQSUyMiUyMiUyQyUyMmRhdGVFbmQlMjIlM0ElMjIlMjIlMkMlMjJjYXQxJTIyJTNBbnVsbCUyQyUyMmNhdDIlMjIlM0FudWxsJTJDJTIyY2F0MyUyMiUzQW51bGwlMkMlMjJjYXQ0JTIyJTNBbnVsbCUyQyUyMnRoZW1lJTIyJTNBbnVsbCUyQyUyMm92ZXJkdWUlMjIlM0FmYWxzZSUyQyUyMmZpbHRlcnMlMjIlM0ElN0IlMjJuZXdDaGVja2JveCUyMiUzQXRydWUlMkMlMjJhcHBvaW50ZWRDaGVja2JveCUyMiUzQXRydWUlMkMlMjJwZXJmb3JtZWRDaGVja2JveCUyMiUzQXRydWUlMkMlMjJjb250cm9sQ2hlY2tib3glMjIlM0F0cnVlJTdEJTdE</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>58186</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="X-Content-Type-Options" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bm9zbmlmZg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-XSS-Protection" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTsgbW9kZT1ibG9jaw==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bm8tY2FjaGUsIG5vLXN0b3JlLCBtYXgtYWdlPTAsIG11c3QtcmV2YWxpZGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Pragma" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bm8tY2FjaGU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Expires" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Frame-Options" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U0FNRU9SSUdJTg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Last-Modified" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VHVlLCAyNyBOb3YgMjAxOCAxNDowMzo0MyBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Ranges" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ynl0ZXM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdDtjaGFyc2V0PVVURi04</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NTgxODY=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U2F0LCAyMiBGZWIgMjAyMCAxMDozNzo1MSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIA0KWC1Db250ZW50LVR5cGUtT3B0aW9uczogbm9zbmlmZg0KWC1YU1MtUHJvdGVjdGlvbjogMTsgbW9kZT1ibG9jaw0KQ2FjaGUtQ29udHJvbDogbm8tY2FjaGUsIG5vLXN0b3JlLCBtYXgtYWdlPTAsIG11c3QtcmV2YWxpZGF0ZQ0KUHJhZ21hOiBuby1jYWNoZQ0KRXhwaXJlczogMA0KWC1GcmFtZS1PcHRpb25zOiBTQU1FT1JJR0lODQpMYXN0LU1vZGlmaWVkOiBUdWUsIDI3IE5vdiAyMDE4IDE0OjAzOjQzIEdNVA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdDtjaGFyc2V0PVVURi04DQpDb250ZW50LUxlbmd0aDogNTgxODYNCkRhdGU6IFNhdCwgMjIgRmViIDIwMjAgMTA6Mzc6NTEgR01UDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>dmFyIGdsVmFsaWRhdG9yID0gdHJ1ZTsKCi8v0JrQvtC90YHRgtGA0YPQutGC0L7RgC4g0JLRi9C/0L7Qu9C90Y/QtdGC0YHRjyDQv9GA0Lgg0L/QtdGA0LXRhdC+0LTQtSDQv9C+IFVSTCAvI2NhdGFsb2cuCmZ1bmN0aW9uIGNhdGFsb2cocm91dGVyKSB7CiAgICBsb2FkQ2F0YWxvZyhyb3V0ZXIpOwp9CgovL9Ck0YPQvdC60YbQuNGPINC/0L7Qu9GD0YfQsNC10YIg0LjQtyDQsdCw0LfRiyDRgdGA0LXQtyDQutCw0YLQsNC70L7Qs9CwINCyINC30LDQstC40YHQuNC80L7RgdGC0Lgg0L7RgiBJRCDRgNC+0LTQuNGC0LXQu9GM0YHQutC+0LPQviDRjdC70LXQvNC10L3RgtCwCmZ1bmN0aW9uIGxvYWRDYXRhbG9nKHRlbXBsYXRlKSB7CiAgICAvL2RlYnVnZ2VyOwogICAgZHVzdC5yZW5kZXJTb3VyY2UodGVtcGxhdGUsIHt9LCBmdW5jdGlvbiAoZXJyLCBvdXQpIHsKICAgICAgICB2YXIgYXBwV3JhcHBlciA9ICQoJyNtYWluX3dyYXBwZXInKTsKICAgICAgICBhcHBXcmFwcGVyLmVtcHR5KCk7CiAgICAgICAgYXBwV3JhcHBlci5hcHBlbmQodGVtcGxhdGUpOwoKICAgICAgICAkKCcjYnJlYWRfd3JhcHBlcicpLmh0bWwoJzxhIGhyZWY9XCcvI1wnIGNsYXNzPVwnaGVhZGVyLWxvZ29cJz48aW1nIHNyYz1cJy4uLy4uL2ltYWdlcy9sb2dvLTVrYS5wbmdcJz48L2E+PHNwYW4+0KHQvtC30LTQsNC90LjQtSDQvdC+0LLQvtCz0L4g0LjQvdGG0LjQtNC10L3RgtCwPC9zcGFuPicpOwogICAgICAgIC8v0J/RgNGP0YfQtdC8INCx0L7QutC+0LLQvtC1INC80LXQvdGOCiAgICAgICAgaGlkZVNpZGVOYXYoKTsKCiAgICAgICAgdmFyIHJvdXRlciA9ICQuUm91dGVyKCk7CiAgICAgICAgdmFyIHF1ZXJ5ID0gcm91dGVyLmFyZ3MgPyByb3V0ZXIuYXJnc1sic2VhcmNoIl0gPyByb3V0ZXIuYXJnc1sic2VhcmNoIl0gOiAiIiA6ICIiOwogICAgICAgIGlmIChxdWVyeSkgewogICAgICAgICAgICBpZiAocXVlcnkgPT09ICIiKSB7CiAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gIiNjYXRhbG9nIjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgdXJsOiAnYXBpL3VzZXIvY2F0YWxvZy9zZWFyY2g/cT0nICsgcXVlcnkKICAgICAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICBzaG93TGV2ZWwoZGF0YS5ub2RlcywgZGVjb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KSwgcm91dGVyLCBkYXRhLnNlcnZpY2VzKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIGN1cnJlbnRMZXZlbCA9IHJvdXRlci5wYXRoWzFdID8gcm91dGVyLnBhdGhbMV0gOiAwOwogICAgICAgICAgICBpZiAod2luZG93Lm91dGVyV2lkdGggPiA0MDApIHsKICAgICAgICAgICAgICAgIC8vcmVuZGVyQnJlYWRjcnVtYnMoY3VycmVudExldmVsLCByb3V0ZXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICB0eXBlOiAnR0VUJywKICAgICAgICAgICAgICAgIHVybDogJ2FwaS91c2VyL2NhdGFsb2cvbm9kZS8nICsgY3VycmVudExldmVsICsgJy9jaGlsZHJlbi8nCiAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIGlmIChkYXRhID09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRMZXZlbCAhPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICdhcGkvdXNlci9jYXRhbG9nL25vZGUvJyArIGN1cnJlbnRMZXZlbCArICcvc2VydmljZS8nCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24gKHNlcnZpY2VzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdHRVQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJ2FwaS91c2VyL2NhdGFsb2cvYnJlYWRjcnVtYnMvJyArIGN1cnJlbnRMZXZlbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbihicmVhZGNydW1icykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge3NlcnZpY2VzOiBzZXJ2aWNlcywgYnJlYWRjcnVtYnM6IGJyZWFkY3J1bWJzfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93Rm9ybShkYXRhLCByb3V0ZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzaG93TGV2ZWwoZGF0YSwgdW5kZWZpbmVkLCByb3V0ZXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgIH0KICAgIH0pOwp9CgovL9Ck0YPQvdC60YbQuNGPINC+0YLRgNC40YHQvtCy0YvQstCw0LXRgiDRgdC10YDQstC40YHRiyDQv9GA0Lgg0L/QvtC40YHQutC1CmZ1bmN0aW9uIHNob3dTZXJ2aWNlcyhzZXJ2aWNlcywgcXVlcnkpIHsKICAgIHZhciAkbWFpbldyYXBwZXIgPSAkKCcjY2F0YWxvZy13cmFwcGVyJyk7CiAgICBpZiAoc2VydmljZXMubGVuZ3RoID4gMCkgewogICAgICAgIHZhciBzZXJ2aWNlTGlzdCA9ICc8ZGl2IGNsYXNzPSJyb3ciPjxkaXYgY2xhc3M9ImNvbCBsMTIgbTEyIHMxMiI+PHAgY2xhc3M9ImNhdGFsb2ctc3VidGV4dCI+0KDQtdC30YPQu9GM0YLQsNGC0Ysg0L/QvtC40YHQutCwINC/0L4gPHN0cm9uZz7RgtC40L/QsNC8PC9zdHJvbmc+INC30LDQv9GA0L7RgdC+0LI6IFwiJyArIHF1ZXJ5ICsgJ1wiPC9wPjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9InJvdyI+PGRpdiBjbGFzcz0iY29sIGwxMiBtMTIgczEyIj48dWwgY2xhc3M9ImNvbGxlY3Rpb24iPic7CiAgICAgICAgc2VydmljZXMuZm9yRWFjaChmdW5jdGlvbiAoc2VydmljZSkgewogICAgICAgICAgICBzZXJ2aWNlTGlzdCArPSAnPGxpIGRhdGEtaWQ9IicgKyBzZXJ2aWNlLmlkICsgJyIgZGF0YS1wYXJlbnQ9IicgKyBzZXJ2aWNlLnBhcmVudElkICsgJyIgY2xhc3M9ImNvbGxlY3Rpb24taXRlbSBzZWFyY2gtc2VydmljZS1saSI+JyArIHNlcnZpY2UucGFyZW50TmFtZSArICcgLT4gJyArIHNlcnZpY2UubmFtZSArICc8L2xpPic7CiAgICAgICAgfSk7CiAgICAgICAgc2VydmljZUxpc3QgKz0gJzwvdWw+PC9kaXY+PC9kaXY+JzsKCiAgICAgICAgJG1haW5XcmFwcGVyLmNoaWxkcmVuKCJkaXYiKS5hcHBlbmQoc2VydmljZUxpc3QpOwoKICAgICAgICB2YXIgJHNlYXJjaFNlcnZpY2UgPSAkKCcuc2VhcmNoLXNlcnZpY2UtbGknKTsKICAgICAgICAkc2VhcmNoU2VydmljZS51bmJpbmQoJ2NsaWNrJyk7CiAgICAgICAgJHNlYXJjaFNlcnZpY2Uub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgcGFyZW50SWQgPSAkKHRoaXMpLmRhdGEoJ3BhcmVudCcpOwogICAgICAgICAgICB2YXIgc2VydmljZUlkID0gJCh0aGlzKS5kYXRhKCdpZCcpOwogICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gJy8jY2F0YWxvZy8nICsgcGFyZW50SWQgKyAnP3NlcnZpY2U9JyArIHNlcnZpY2VJZDsKICAgICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgICAgJG1haW5XcmFwcGVyLmNoaWxkcmVuKCJkaXYiKS5hcHBlbmQoJzxkaXYgY2xhc3M9InJvdyI+PGRpdiBjbGFzcz0iY29sIGwxMiBtMTIgczEyIj48cCBjbGFzcz0iY2F0YWxvZy1zdWJ0ZXh0Ij7Qn9C+INC30LDQv9GA0L7RgdGDICInICsgcXVlcnkgKyAnIiDQvdC40YfQtdCz0L4g0L3QtSDQvdCw0LnQtNC10L3Qvi4g0JLQvtGB0L/QvtC70YzQt9GD0LnRgtC10YHRjCDQutCw0YLQsNC70L7Qs9C+0LwuPC9wPjwvZGl2PjwvZGl2PicpOwogICAgfQp9CgovL9Ck0YPQvdC60YbQuNGPINC+0YLRgNC40YHQvtCy0YvQstCw0LXRgiDRgdGA0LXQtyDQutCw0YLQsNC70L7Qs9CwINC90LAg0Y3QutGA0LDQvdC1CmZ1bmN0aW9uIHNob3dMZXZlbChkYXRhLCBxdWVyeSwgcm91dGVyLCBzZXJ2aWNlUXVlcnkpIHsKICAgICQuYWpheCh7CiAgICAgICAgdHlwZTogIkdFVCIsCiAgICAgICAgdXJsOiAiYXBpL3VzZXIvY2F0YWxvZy90cmVldmlldyIKICAgIH0pLmRvbmUoZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAvLyDQntCx0YrQtdC60YIg0LTQu9GPINC/0L7QuNGB0LrQsCDRgdGB0YvQu9C60Lgg0L3QsCDRgdC+0LfQtNCw0L3QuNC1INC/0L4g0YLQtdC60YHRgtGDINGB0LXRgNCy0LjRgdCwCiAgICAgICAgdmFyIHNlcnZpY2VMaW5rcyA9IFtdOwogICAgICAgIC8v0KfQuNGB0YLQuNC8INCy0YDQsNC/0L/QtdGACiAgICAgICAgdmFyICRtYWluV3JhcHBlciA9ICQoIiNjYXRhbG9nLXdyYXBwZXIiKTsKICAgICAgICAkbWFpbldyYXBwZXIuZW1wdHkoKTsKCiAgICAgICAgLy/QodC+0LHQuNGA0LDQtdC8INGI0LDQv9C60YMg0YDQsNC30LTQtdC70LAg0YEg0LrQsNGC0LDQu9C+0LPQvtC8CiAgICAgICAgJG1haW5XcmFwcGVyLmFwcGVuZCgiPGRpdiBjbGFzcz0nY29udGFpbmVyJyBzdHlsZT0nbWFyZ2luLXRvcDogMzBweDsnPiIpOwogICAgICAgICRtYWluV3JhcHBlci5jaGlsZHJlbigiZGl2IikuYXBwZW5kKCI8ZGl2IGNsYXNzPSdyb3cnPiIgKwogICAgICAgICAgICAiPGRpdiBjbGFzcz0nY29sIGwxMiBtMTIgczEyJz4iICsKICAgICAgICAgICAgIjxoMSBjbGFzcz0nY2F0YWxvZy1oZWFkZXInPtCf0L4g0LrQsNC60L7QvNGDINCy0L7Qv9GA0L7RgdGDINCy0LDQvCDRgtGA0LXQsdGD0LXRgtGB0Y8g0L/QvtC80L7RidGMPzwvaDE+IiArCiAgICAgICAgICAgICI8cCBjbGFzcz0nY2F0YWxvZy1zdWJ0ZXh0Jz7QktGL0L/QvtC70L3QuNGC0LUg0L/QvtC40YHQuiDQuNC70Lgg0LLRi9Cx0LXRgNC40YLQtSDRgtC10LzRgyDQuNC3INC60LDRgtCw0LvQvtCz0LAg0L3QuNC20LU8L3A+IiArCiAgICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICAgIjxkaXYgY2xhc3M9J2NvbCBsMTIgbTEyIHMxMic+IiArCiAgICAgICAgICAgICI8ZGl2IGNsYXNzPSdjYXRhbG9nLXNlYXJjaC13cmFwcGVyIHNlYXJjaC13cmFwcGVyJz48aW5wdXQgY2xhc3M9J1BMXzEwX0JTX0JCJyBpZD0nc2VhcmNoJyBwbGFjZWhvbGRlcj0n0J/QvtC40YHQuiDQv9C+INGC0LXQvNCw0LwnIHZhbHVlID0nIiArIChxdWVyeSA/IHF1ZXJ5IDogIiIpICsgIic+PGkgaWQ9J3NlYXJjaF9idXR0b24nIGNsYXNzPSdtYXRlcmlhbC1pY29ucyc+c2VhcmNoPC9pPjxpIGlkPSdjbGVhcl9zZWFyY2gnIGNsYXNzPSciICsgKHF1ZXJ5ID8gIiIgOiAiZWUtaGlkZGVuICIpICsgInNlYXJjaC1jbGVhciBtYXRlcmlhbC1pY29ucyc+Y2xvc2U8L2k+PC9kaXY+PC9kaXY+Iik7CgoKICAgICAgICB2YXIgbmVzdGVkQWNjb3JkaW9uID0gIiI7CgogICAgICAgIGlmIChkYXRhICE9PSBbXSkgewogICAgICAgICAgICBkcmF3QWNjb3JkaW9uTGV2ZWwoZGF0YSk7CiAgICAgICAgfQoKICAgICAgICAvL9CvIDwzINCg0LXQutGD0YDRgdC40LLQvdGL0LUg0LLRi9C30L7QstGLLCDQvtC90Lgg0L/QvtC60LDQt9GL0LLQsNGO0YIg0YHRgtC10L/QtdC90Ywg0LzQvtC10Lkg0LrRgNGD0YLQuNC30L3RiwogICAgICAgIGZ1bmN0aW9uIGRyYXdBY2NvcmRpb25MZXZlbChkYXRhKSB7CiAgICAgICAgICAgIG5lc3RlZEFjY29yZGlvbiArPSAnPHVsIGNsYXNzPSJjb2xsYXBzaWJsZSBjYXRhbG9nLXVsIiBkYXRhLWNvbGxhcHNpYmxlPSJleHBhbmRhYmxlIj4nOwogICAgICAgICAgICBkYXRhLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgICAgIG5lc3RlZEFjY29yZGlvbiArPSAnPGxpPjxkaXYgZGF0YS1pZD0iJyArIG5vZGUuaWQgKyAnIiBjbGFzcz0iY29sbGFwc2libGUtaGVhZGVyIj4nICsgbm9kZS5uYW1lICsgJzwvZGl2PjxkaXYgY2xhc3M9ImNhdGFsb2ctY29sbGFwc2libGUgY29sbGFwc2libGUtYm9keSI+JzsKICAgICAgICAgICAgICAgIGlmIChub2RlLmhhc093blByb3BlcnR5KCJjaGlsZHJlbiIpKSB7CiAgICAgICAgICAgICAgICAgICAgZHJhd0FjY29yZGlvbkxldmVsKG5vZGUuY2hpbGRyZW4pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlLmhhc093blByb3BlcnR5KCJzZXJ2aWNlcyIpKSB7CiAgICAgICAgICAgICAgICAgICAgbmVzdGVkQWNjb3JkaW9uICs9ICc8dWwgY2xhc3M9Im5lc3RlZC1zZXJ2aWNlcyI+JzsKICAgICAgICAgICAgICAgICAgICBub2RlLnNlcnZpY2VzLmZvckVhY2goZnVuY3Rpb24gKHNlcnZpY2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZUxpbmtzLnB1c2goe25hbWU6IHNlcnZpY2UubmFtZSwgbGluazogJy8jY2F0YWxvZy8nICsgbm9kZS5pZCArICc/c2VydmljZT0nICsgc2VydmljZS5pZH0pOwogICAgICAgICAgICAgICAgICAgICAgICBuZXN0ZWRBY2NvcmRpb24gKz0gJzxsaT48YSBocmVmPSIvI2NhdGFsb2cvJyArIHNlcnZpY2UucGFyZW50SWQgKyAnP3NlcnZpY2U9JyArIHNlcnZpY2UuaWQgKyAnIj4nICsgc2VydmljZS5uYW1lICsgJzwvYT48L2xpPic7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBuZXN0ZWRBY2NvcmRpb24gKz0gJzwvZGl2PjwvbGk+JzsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIG5lc3RlZEFjY29yZGlvbiArPSAnPC91bD4nOwogICAgICAgIH0KICAgICAgICBuZXN0ZWRBY2NvcmRpb24gKz0gJzxkaXYgY2xhc3M9ImJ1dHRvbi1sZWZ0Ij48YSBocmVmPSIvI3RpY2tldHM/c3RhdGU9b3BlbmVkIiBjbGFzcz0id2F2ZXMtZWZmZWN0IHdhdmVzLWxpZ2h0IGJ0biI+0J3QsNC30LDQtDwvYT48L2Rpdj4nOwogICAgICAgICRtYWluV3JhcHBlci5jaGlsZHJlbigiZGl2IikuYXBwZW5kKG5lc3RlZEFjY29yZGlvbik7CgogICAgICAgIC8v0JXRgdC70Lgg0LXRgdGC0Ywg0L/Rg9C7INGB0LXRgNCy0LjRgdC+0LIg0YLQviDRgNC40YHRg9C10Lwg0LjRhSDRgNC10LfRg9C70YzRgtCw0YIg0L/QvtC40YHQutCwCiAgICAgICAgaWYgKHNlcnZpY2VRdWVyeSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHNob3dTZXJ2aWNlcyhzZXJ2aWNlUXVlcnksIGRlY29kZVVSSUNvbXBvbmVudChxdWVyeSkpOwogICAgICAgIH0KCiAgICAgICAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsKICAgICAgICAgICAgJCgnLmNvbGxhcHNpYmxlJykuY29sbGFwc2libGUoKTsKICAgICAgICB9KTsKCiAgICAgICAgLy/Qn9C+0LjRgdC6INC/0L4g0L3QsNC20LDRgtC40Y4g0L3QsCDQu9GD0L/RgwogICAgICAgICQoJyNzZWFyY2hfYnV0dG9uJykuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgc2VhcmNoVGV4dCA9ICQoIiNzZWFyY2giKS52YWwoKTsKICAgICAgICAgICAgaWYgKHNlYXJjaFRleHQgIT09ICIiKSB7CiAgICAgICAgICAgICAgICBicmVhZGNydW1icyA9IFtdOwogICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9ICIjY2F0YWxvZz9zZWFyY2g9IiArIGVuY29kZVVSSUNvbXBvbmVudChzZWFyY2hUZXh0KSArICgocm91dGVyLmFyZ3NbInVzZXIiXSkgPyAoIiZ1c2VyPSIgKyByb3V0ZXIuYXJnc1sidXNlciJdKSA6ICgiIikpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHNlYXJjaFRleHQgPT09ICIiKSB7CiAgICAgICAgICAgICAgICBicmVhZGNydW1icyA9IFtdOwogICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9ICIjY2F0YWxvZyIgKyAoKHJvdXRlci5hcmdzWyJ1c2VyIl0pID8gKCI/dXNlcj0iICsgcm91dGVyLmFyZ3NbInVzZXIiXSkgOiAoIiIpKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvL9Ca0YDQtdGB0YLQuNC6CiAgICAgICAgdmFyIGNsZWFyU2VhcmNoID0gJCgnI2NsZWFyX3NlYXJjaCcpLAogICAgICAgICAgICBzZWFyY2hJbnB1dCA9ICQoIiNzZWFyY2giKTsKCiAgICAgICAgLy/Qn9C+0LjRgdC6INC/0L4gRW50ZXIKICAgICAgICBzZWFyY2hJbnB1dC5vbigna2V5cHJlc3MnLCBmdW5jdGlvbiAoZXZ0KSB7CiAgICAgICAgICAgIHZhciBzZWFyY2hUZXh0ID0gJCgiI3NlYXJjaCIpLnZhbCgpOwoKICAgICAgICAgICAgdmFyIGtleSA9IGV2dC53aGljaCB8fCBldnQuY2hhckNvZGUgfHwgZXZ0LmtleUNvZGUgfHwgMDsKCiAgICAgICAgICAgIGlmICgoa2V5ID09IDEzKSAmJiAoc2VhcmNoVGV4dCAhPSAiIikpIHsKICAgICAgICAgICAgICAgIGJyZWFkY3J1bWJzID0gW107CiAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gIiNjYXRhbG9nP3NlYXJjaD0iICsgZW5jb2RlVVJJQ29tcG9uZW50KHNlYXJjaFRleHQpICsgKChyb3V0ZXIuYXJnc1sidXNlciJdKSA/ICgiJnVzZXI9IiArIHJvdXRlci5hcmdzWyJ1c2VyIl0pIDogKCIiKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoKGtleSA9PSAxMykgJiYgKHNlYXJjaFRleHQgPT0gIiIpKSB7CiAgICAgICAgICAgICAgICBicmVhZGNydW1icyA9IFtdOwogICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9ICIjY2F0YWxvZyIgKyAoKHJvdXRlci5hcmdzWyJ1c2VyIl0pID8gKCI/dXNlcj0iICsgcm91dGVyLmFyZ3NbInVzZXIiXSkgOiAoIiIpKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvLyDQn9C+0LTRgdC60LDQt9C60LgKICAgICAgICB2YXIgYXV0b2NvbXBsZXRlOwoKICAgICAgICB2YXIgbmFtZXMgPSB7fTsKICAgICAgICBzZXJ2aWNlTGlua3MuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgbmFtZXNbdmFsdWUubmFtZV0gPSBudWxsOwogICAgICAgIH0pOwogICAgICAgIHNlYXJjaElucHV0LmF1dG9jb21wbGV0ZSh7CiAgICAgICAgICAgIGRhdGE6IG5hbWVzLAogICAgICAgICAgICBvbkF1dG9jb21wbGV0ZTogZnVuY3Rpb24gKHZhbCkgewogICAgICAgICAgICAgICAgc2VydmljZUxpbmtzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYodmFsID09PSB2YWx1ZS5uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSB2YWx1ZS5saW5rOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvL9Cn0LjRgdGC0LjQvCDRgdGC0YDQvtC60YMg0L/QvtC40YHQutCwINC/0L4g0L3QsNC20LDRgtC40Lgg0L3QsCDQutGA0LXRgdGC0LjQugogICAgICAgIGNsZWFyU2VhcmNoLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHNlYXJjaElucHV0LnZhbCgiIik7CiAgICAgICAgICAgIGlmICghY2xlYXJTZWFyY2guaGFzQ2xhc3MoImVlLWhpZGRlbiIpKSBjbGVhclNlYXJjaC5hZGRDbGFzcygiZWUtaGlkZGVuIik7CiAgICAgICAgICAgIGJyZWFkY3J1bWJzID0gW107CiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSAiI2NhdGFsb2ciICsgKChyb3V0ZXIuYXJnc1sidXNlciJdKSA/ICgiP3VzZXI9IiArIHJvdXRlci5hcmdzWyJ1c2VyIl0pIDogKCIiKSk7CiAgICAgICAgfSk7CgogICAgICAgIC8v0J/QvtC60LDQt9GL0LLQsNC10Lwg0LrRgNC10YHRgtC40Log0LIg0LfQsNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCINGB0L7RgdGC0L7Rj9C90LjQuCDQv9C+0LjRgdC60LAg0LjQu9C4INGB0LrRgNGL0LLQsNC10LwKICAgICAgICBzZWFyY2hJbnB1dC5vbignaW5wdXQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGlmIChzZWFyY2hJbnB1dC52YWwoKSAhPT0gIiIpIHsKICAgICAgICAgICAgICAgIGlmIChjbGVhclNlYXJjaC5oYXNDbGFzcygiZWUtaGlkZGVuIikpIGNsZWFyU2VhcmNoLnJlbW92ZUNsYXNzKCJlZS1oaWRkZW4iKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICghY2xlYXJTZWFyY2guaGFzQ2xhc3MoImVlLWhpZGRlbiIpKSBjbGVhclNlYXJjaC5hZGRDbGFzcygiZWUtaGlkZGVuIik7CiAgICAgICAgICAgIH0KICAgICAgICB9KQogICAgfSk7Cn0KCi8v0KTRg9C90LrRhtC40Y8g0L7RgtGA0LjRgdC+0LLRi9Cy0LDQtdGCINGI0LDQsdC70L7QvSDQt9Cw0LLQtdC00LXQvdC40Y8g0LfQsNGP0LLQutC4CmZ1bmN0aW9uIHNob3dGb3JtKGRhdGEsIHJvdXRlcikgewogICAgLy8g0KHQv9C40YHQvtC6INGC0LXQvCDRgSDQvtCx0Y/Qt9Cw0YLQtdC70YzQvdGL0Lwg0L/RgNC40LrRgNC10L/Qu9C10L3QuNC10Lwg0YTQsNC50LvQsAogICAgdmFyIHJlcWlyZWRGaWxlTGlzdCA9IFsgJ9CS0YvQstC+0Lcg0LzRg9GB0L7RgNCwJywgJ9CX0LDQutCw0Lcg0LTQvtC/0L7Qu9C90LjRgtC10LvRjNC90L7Qs9C+INCy0YvQstC+0LfQsCDQvNGD0YHQvtGA0LAnLCAn0JHRg9C90LrQtdGAINC00LvRjyDQmtCT0JwgOCDQutGD0LEu0LwnLAogICAgICAgICfQotGA0LXQsdGD0LXRgtGB0Y8g0LfQsNC80LXQvdCwINCy0L3Rg9GC0YDQtdC90L3QtdC5INC90LDQstC40LPQsNGG0LjQuCAo0YPQutCw0LfQsNGC0Ywg0YfRgtC+INC40LzQtdC90L3QviknIF07CiAgICBpZihyb3V0ZXIuYXJncy51c2VyKXsKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB0eXBlOiAiR0VUIiwKICAgICAgICAgICAgdXJsOiAiYXBpL3VzZXIvIiArIHJvdXRlci5hcmdzLnVzZXIgKyAiL2luZm8iCiAgICAgICAgfSkuZG9uZShmdW5jdGlvbiAodXNlckluZm8pIHsKICAgICAgICAgICAgZHJhd0Zvcm0odXNlckluZm8pOwogICAgICAgIH0pCiAgICB9IGVsc2UgewogICAgICAgIGRyYXdGb3JtKHVuZGVmaW5lZCk7CiAgICB9CiAgICBmdW5jdGlvbiBkcmF3Rm9ybSh1c2VySW5mbykgewogICAgICAgIHZhciBzZXJ2aWNlSWQ7CiAgICAgICAgdmFyIGlzSW52ZW50b3J5ID0gZmFsc2U7CiAgICAgICAgdmFyIHJvb3RTZXJ2aWNlSWQ7CiAgICAgICAgdmFyIHNlcnZpY2VJZENhbmRpZGF0ZTsKICAgICAgICB2YXIgcXVlc3Rpb25SZXN1bHQgPSBbXTsKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmw6ICdkaXJlY3Rvci9hZGR0aWNrZXQuZHVzdCcsCiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAiY2hhcnNldD11dGYtOCIKICAgICAgICB9KS5kb25lKGZ1bmN0aW9uICh0ZW1wbGF0ZSkgewogICAgICAgICAgICBpZiAodXNlckluZm8gIT09IHVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICBkYXRhLm90aGVyRnVsbE5hbWUgPSB1c2VySW5mby5mdWxsTmFtZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBkdXN0LnJlbmRlclNvdXJjZSh0ZW1wbGF0ZSwgZGF0YSwgZnVuY3Rpb24gKGVyciwgb3V0KSB7CiAgICAgICAgICAgICAgICB2YXIgJG1haW5XcmFwcGVyID0gJCgiI2NhdGFsb2ctd3JhcHBlciIpOwogICAgICAgICAgICAgICAgJG1haW5XcmFwcGVyLmVtcHR5KCk7CiAgICAgICAgICAgICAgICAkbWFpbldyYXBwZXIuYXBwZW5kKG91dCk7CiAgICAgICAgICAgICAgICB2YXIgYWRkVGlja2V0UGF0aCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoOwogICAgICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApOwoKICAgICAgICAgICAgICAgIC8qdmFyIGNvb2tpZURyYWZ0ID0gJC5jb29raWUoJ3RpY2tldC5kcmFmdC4nICsgcm91dGVyLnBhdGhbMV0pOwogICAgICAgICAgICAgICAgaWYoY29va2llRHJhZnQgIT09IHVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgICAgdmFyICRkcmFmdENvbnRhaW5lciA9ICQoJyNkcmFmdENvbnRhaW5lcicpOwogICAgICAgICAgICAgICAgICAgICRkcmFmdENvbnRhaW5lci5lbXB0eSgpLmFwcGVuZCgiPGRpdiBjbGFzcz0ncm93Jz48ZGl2IGNsYXNzPSdjb2wgbDEyIG0xMiBzMTInPjx1bCBjbGFzcz0nY29sbGVjdGlvbic+PGxpIGNsYXNzPSdjb2xsZWN0aW9uLWl0ZW0nPjxkaXY+0KMg0LLQsNGBINC40LzQtdC10YLRgdGPINGB0L7RhdGA0LDQvdC10L3QvdGL0Lkg0YfQtdGA0L3QvtCy0LjQuiDQtNC70Y8g0LTQsNC90L3QvtC5INC30LDRj9Cy0LrQuC4g0JLQvtGB0YHRgtCw0L3QvtCy0LjRgtGMINC30LDQv9C+0LvQvdC10L3QvdGL0LUg0L/QvtC70Y8/PGEgaWQ9J3Jlc3RvcmVGcm9tRHJhZnQnIGNsYXNzPSdzZWNvbmRhcnktY29udGVudCc+PGkgY2xhc3M9J3Jlc3RvcmUtaWNvbiBtYXRlcmlhbC1pY29ucyc+cmVwbGF5PC9pPjwvYT48L2Rpdj48L2xpPjwvdWw+PC9kaXY+PC9kaXY+Iik7CiAgICAgICAgICAgICAgICAgICAgdmFyICRyZXN0b3JlRnJvbURyYWZ0ID0gJCgnI3Jlc3RvcmVGcm9tRHJhZnQnKTsKICAgICAgICAgICAgICAgICAgICAkcmVzdG9yZUZyb21EcmFmdC51bmJpbmQoJ2NsaWNrJyk7CiAgICAgICAgICAgICAgICAgICAgJHJlc3RvcmVGcm9tRHJhZnQub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAvL3Jlc3RvcmVEcmFmdChjb29raWVEcmFmdCwgcm91dGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgJGRyYWZ0Q29udGFpbmVyLmVtcHR5KCk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0qLwoKICAgICAgICAgICAgICAgIC8v0J/RgNC+0LLQtdGA0Y/QtdC8INGD0YXQvtC0INGB0L4g0YHRgtGA0LDQvdC40YbRiyDQv9GA0Lgg0L3QsNC70LjRh9C40Lgg0LfQsNC/0L7Qu9C90LXQvdC90L7Qs9C+INC+0L/QuNGB0LDQvdC40Y8KICAgICAgICAgICAgICAgIC8qd2luZG93Lm9uaGFzaGNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgJHRpY2tldERlc2NyaXB0aW9uID0gJCgnI3RpY2tldF9kZXNjcmlwdGlvbicpOwogICAgICAgICAgICAgICAgICAgIGlmICgkdGlja2V0RGVzY3JpcHRpb24udmFsKCkgIT0gIiIgJiYgJHRpY2tldERlc2NyaXB0aW9uLmxlbmd0aCA9PSAxICYmIGFkZFRpY2tldFBhdGggIT0gd2luZG93LmxvY2F0aW9uLmhhc2gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF90aWNrZXRfbGVmdCcpLm1vZGFsKCdvcGVuJyk7CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGFjY2VwdExlZnQgPSAkKCcjYWRkX3RpY2tldF9sZWZ0X2NvbmZpcm0nKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkZWNsaW5lTGVmdCA9ICQoJyNhZGRfdGlja2V0X2xlZnRfZGVjbGluZScpOwoKICAgICAgICAgICAgICAgICAgICAgICAgJGFjY2VwdExlZnQudW5iaW5kKCJjbGljayIpOwogICAgICAgICAgICAgICAgICAgICAgICAkYWNjZXB0TGVmdC5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWRkX3RpY2tldF9sZWZ0JykubW9kYWwoJ2Nsb3NlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkQ29udGVudCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICRkZWNsaW5lTGVmdC51bmJpbmQoImNsaWNrIik7CiAgICAgICAgICAgICAgICAgICAgICAgICRkZWNsaW5lTGVmdC5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWRkX3RpY2tldF9sZWZ0JykubW9kYWwoJ2Nsb3NlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9IGFkZFRpY2tldFBhdGg7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZGRUaWNrZXRQYXRoICE9IHdpbmRvdy5sb2NhdGlvbi5oYXNoIHx8ICR0aWNrZXREZXNjcmlwdGlvbi52YWwoKSA9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRDb250ZW50KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9Ki8KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvKnZhciAkY29udGFjdCA9ICQoJyNjb250YWN0Jyk7CiAgICAgICAgICAgICRjb250YWN0Lm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBzYXZlRHJhZnRUb09iamVjdChyb3V0ZXIpOwogICAgICAgICAgICB9KTsqLwoKICAgICAgICAgICAgLy/Qn9C+0LTRgdC60LDQt9C60LAg0L/RgNC4INC90LDQstC10LTQtdC90LjQuCDQvdCwIGkKICAgICAgICAgICAgLyokKCcudG9vbHRpcHBlZCcpLnRvb2x0aXAoewogICAgICAgICAgICAgICAgZGVsYXk6IDUwLAogICAgICAgICAgICAgICAgdG9vbHRpcDogItCc0LDQutGB0LjQvNCw0LvRjNC90L4g0L/QvtC00YDQvtCx0L3QviDQvtC/0LjRiNC40YLQtSDQv9GA0LjRh9C40L3RgyDQstCw0YjQtdCz0L4g0L7QsdGA0LDRidC10L3QuNGPLCDQstC90LjQvNCw0YLQtdC70YzQvdC+INC30LDQv9C+0LvQvdC40YLQtSDQstGB0LUg0L/QvtC70Y8g0YTQvtGA0LzRiyDQtNC70Y8g0YHQutC+0YDQtdC50YjQtdCz0L4g0YDQsNGB0YHQvNC+0YLRgNC10L3QuNGPINCy0LDRiNC10LPQviDQvtCx0YDQsNGJ0LXQvdC40Y8uIiwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAiYm90dG9tIgogICAgICAgICAgICB9KTsqLwogICAgICAgICAgICAvLyQoJ3NlbGVjdDpub3QoI2ludmVudG9yeV9udW0pJykKCiAgICAgICAgICAgIHZhciAkaW52ZW50b3J5TnVtID0gJCgnI2ludmVudG9yeV9udW0nKTsKICAgICAgICAgICAgLy/QnNCw0YHQutCwCiAgICAgICAgICAgIC8vJCgnI3Rhc2tfcGhvbmUnKS5tYXNrKCI4KDk5OSkgOTk5LTk5OTkiKTsKCiAgICAgICAgICAgIC8v0JjQvdC40YbQuNCw0LvQuNC30LDRhtC40Y8g0YHQtdC70LXQutGC0L7RgNCwCiAgICAgICAgICAgIHZhciBwcm9ibGVtU2VsZWN0b3IgPSAkKCcjdGlja2V0X25hbWUnKTsKICAgICAgICAgICAgLy/QntCx0YDQsNCx0L7RgtGH0LjQutC4INGBINGC0LDQudC80LDRg9GC0L7QvCDQtNC70Y8g0YHQvtGF0YDQsNC90LXQvdC40Y8g0LTRgNCw0YTRgtCwCiAgICAgICAgICAgLyogdmFyIHRpbWVvdXREZXNjcmlwdGlvbjsKICAgICAgICAgICAgdmFyICR0aWNrZXREZXNjcmlwdGlvbiA9ICQoJyN0aWNrZXRfZGVzY3JpcHRpb24nKTsKICAgICAgICAgICAgJHRpY2tldERlc2NyaXB0aW9uLnVuYmluZCgna2V5dXAnKTsKICAgICAgICAgICAgJHRpY2tldERlc2NyaXB0aW9uLm9uKCdrZXl1cCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGlmKHRpbWVvdXREZXNjcmlwdGlvbikgewogICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0RGVzY3JpcHRpb24pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGltZW91dERlc2NyaXB0aW9uID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc2F2ZURyYWZ0VG9PYmplY3Qocm91dGVyKTsKICAgICAgICAgICAgICAgIH0sIDYwMCk7CgogICAgICAgICAgICB9KTsqLwoKICAgICAgICAgICAgLyovL9Ce0LHRgNCw0LHQvtGC0YfQuNC60Lgg0YEg0YLQsNC50LzQsNGD0YLQvtC8INC00LvRjyDRgdC+0YXRgNCw0L3QtdC90LjRjyDQtNGA0LDRhNGC0LAKICAgICAgICAgICAgdmFyIHRpbWVvdXROYW1lOwogICAgICAgICAgICB2YXIgJHRpY2tldFVzZXJOYW1lID0gJCgnI3Rhc2tfdXNlcm5hbWUnKTsKICAgICAgICAgICAgJHRpY2tldFVzZXJOYW1lLnVuYmluZCgna2V5dXAnKTsKICAgICAgICAgICAgJHRpY2tldFVzZXJOYW1lLm9uKCdrZXl1cCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGlmKHRpbWVvdXROYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXROYW1lKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRpbWVvdXROYW1lID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc2F2ZURyYWZ0VG9PYmplY3Qocm91dGVyKTsKICAgICAgICAgICAgICAgIH0sIDYwMCk7CgogICAgICAgICAgICB9KTsqLwoKICAgICAgICAgICAgLyovL9Ce0LHRgNCw0LHQvtGC0YfQuNC60Lgg0YEg0YLQsNC50LzQsNGD0YLQvtC8INC00LvRjyDRgdC+0YXRgNCw0L3QtdC90LjRjyDQtNGA0LDRhNGC0LAKICAgICAgICAgICAgdmFyIHRpbWVvdXRQaG9uZTsKICAgICAgICAgICAgdmFyICR0aWNrZXRQaG9uZSA9ICQoJyN0YXNrX3Bob25lJyk7CiAgICAgICAgICAgICR0aWNrZXRQaG9uZS51bmJpbmQoJ2tleXVwJyk7CiAgICAgICAgICAgICR0aWNrZXRQaG9uZS5vbigna2V5dXAnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZih0aW1lb3V0UGhvbmUpIHsKICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dFBob25lKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRpbWVvdXRQaG9uZSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHNhdmVEcmFmdFRvT2JqZWN0KHJvdXRlcik7CiAgICAgICAgICAgICAgICB9LCA2MDApOwoKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvL9Ce0LHRgNCw0LHQvtGC0YfQuNC60Lgg0YEg0YLQsNC50LzQsNGD0YLQvtC8INC00LvRjyDRgdC+0YXRgNCw0L3QtdC90LjRjyDQtNGA0LDRhNGC0LAKICAgICAgICAgICAgdmFyIHRpbWVvdXRNYWlsOwogICAgICAgICAgICB2YXIgJHRpY2tldE1haWwgPSAkKCcjdGFza19tYWlsJyk7CiAgICAgICAgICAgICR0aWNrZXRNYWlsLnVuYmluZCgna2V5dXAnKTsKICAgICAgICAgICAgJHRpY2tldE1haWwub24oJ2tleXVwJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaWYodGltZW91dE1haWwpIHsKICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dE1haWwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGltZW91dE1haWwgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBzYXZlRHJhZnRUb09iamVjdChyb3V0ZXIpOwogICAgICAgICAgICAgICAgfSwgNjAwKTsKCiAgICAgICAgICAgIH0pOyovCgogICAgICAgICAgICB2YXIgdGVtcGxhdGVXcmFwcGVyID0gJCgnI3NlcnZpY2VfdGVtcGxhdGUnKTsKICAgICAgICAgICAgcHJvYmxlbVNlbGVjdG9yLnVuYmluZCgnY2hhbmdlJyk7CiAgICAgICAgICAgIHByb2JsZW1TZWxlY3Rvci5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgLy9jaGVja0ludmVudGFyeSgkKHRoaXMpLnZhbCgpKTsKICAgICAgICAgICAgICAgIC8vY2hlY2tEdXBsaWNhdGVzKCQodGhpcykudmFsKCkpOyBUT0RPOiDQn9C10YDQtdC00LXQu9Cw0YLRjCDQv9GA0L7QstC10YDQutGDINC00YPQsdC70LjQutCw0YLQvtCyINC/0L7QtCDQsdC40LfQvdC10YEt0L/RgNC+0YbQtdGB0YEg0KLQoTUKICAgICAgICAgICAgICAgIC8vc2F2ZURyYWZ0VG9PYmplY3Qocm91dGVyKTsKCiAgICAgICAgICAgICAgICAkKCcuYWpheC11cGxvYWQtZHJhZ2Ryb3AnKS5yZW1vdmVDbGFzcygncmVkLWRvdHRlZC1ib3JkZXInKTsKCiAgICAgICAgICAgICAgICBpZiAodGVtcGxhdGVXcmFwcGVyLmhhc0NsYXNzKCd0ZW1wbGF0ZS1leHQnKSkgewogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlV3JhcHBlci5yZW1vdmVDbGFzcygndGVtcGxhdGUtZXh0JykKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVdyYXBwZXIuZW1wdHkoKTsKICAgICAgICAgICAgICAgIHNlcnZpY2VJZCA9ICQodGhpcykudmFsKCk7CiAgICAgICAgICAgICAgICByb290U2VydmljZUlkID0gJCh0aGlzKS52YWwoKTsKCiAgICAgICAgICAgICAgICBpZiAoJGludmVudG9yeU51bS5oYXNDbGFzcygic2VsZWN0Mi1oaWRkZW4tYWNjZXNzaWJsZSIpKSB7CiAgICAgICAgICAgICAgICAgICAgJGludmVudG9yeU51bS52YWwobnVsbCk7CiAgICAgICAgICAgICAgICAgICAgJGludmVudG9yeU51bS5zZWxlY3QyKCdkZXN0cm95Jyk7CiAgICAgICAgICAgICAgICAgICAgLy/QldGB0LvQuCDQvdC1INC+0YfQuNGJ0LDRgtGMLCDQvtGCINCy0L3Rg9GC0YDQuCDRgdC10LvQtdC60YLQsCDQvtGB0YLQsNGO0YLRgdGPINCy0YvQsdGA0LDQvdC90YvQtSDQsiDQv9GA0L7RiNC70YvQuSDRgNCw0Lcgb3B0aW9ucyDQuCDQv9GA0Lgg0LLRi9Cx0L7RgNC1INC40YUg0LIg0L/QvtCy0YLQvtGA0L3Ri9C5INGA0LDQtyDQuNC80Y8g0L3QtSDQvtGC0L7QsdGA0LDQttCw0LXRgtGB0Y8gwq9cKG9fbykvwq8KICAgICAgICAgICAgICAgICAgICAkaW52ZW50b3J5TnVtLmVtcHR5KCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgICAgICB1cmw6ICIvYXBpL2ludmVudG9yeU51bWJlcnM/c2VydmljZUlkPSIgKyBzZXJ2aWNlSWQsCiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJywKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiR0VUIgogICAgICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY29udGVudCAmJiBkYXRhLmNvbnRlbnQubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAkaW52ZW50b3J5TnVtLnZhbChudWxsKTsKICAgICAgICAgICAgICAgICAgICAgICAgJGludmVudG9yeU51bS5lbXB0eSgpOwogICAgICAgICAgICAgICAgICAgICAgICAkaW52ZW50b3J5TnVtLnNlbGVjdDIoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyQ3NzQ2xhc3M6ICdtYXRlcmlhbF9saWtlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAi0JLRi9Cx0LXRgNC40YLQtSDQuNC90LLQtdC90YLQsNGA0L3Ri9C5INC90L7QvNC10YAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWpheDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogImFwaS9pbnZlbnRvcnlOdW1iZXJzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJHRVQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VJZDogc2VydmljZUlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcTogcGFyYW1zLnRlcm0gPyBwYXJhbXMudGVybSA6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZTogKHBhcmFtcy5wYWdlIHx8IDEpIC0gMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc1Jlc3VsdHM6IGZ1bmN0aW9uIChkYXRhLCBwYXJhbXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHM6IGRhdGEuY29udGVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2luYXRpb246IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3JlOiAhZGF0YS5sYXN0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVzY2FwZU1hcmt1cDogZnVuY3Rpb24gKG1hcmt1cCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXJrdXA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAvLyBsZXQgb3VyIGN1c3RvbSBmb3JtYXR0ZXIgd29yawogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVSZXN1bHQ6IGZ1bmN0aW9uIChncm91cCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBncm91cC5udW1iZXIgKyAiIOKAlCAiICsgZ3JvdXAubmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVNlbGVjdGlvbjogZnVuY3Rpb24gKGdyb3VwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwLm51bWJlciA/IGdyb3VwLm51bWJlciArICIg4oCUICIgKyBncm91cC5uYW1lIDogZ3JvdXAudGV4dDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogIjEwMCUiCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRpbnZlbnRvcnlOdW0uc2VsZWN0Mih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXJDc3NDbGFzczogJ21hdGVyaWFsX2xpa2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICLQmNC90LLQtdC90YLQsNGA0L3Ri9C1INC90L7QvNC10YDQsCDQvtGC0YHRg9GC0YHRgtCy0YPRjtGCIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICIxMDAlIgogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCgoKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5zZXJ2aWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnZhbCgpID09IGRhdGEuc2VydmljZXNbaV0uaWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFsZXJ0TWVzc2FnZSA9ICQoJyN0aWNrZXRfYWxlcnQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy/Ql9Cw0Y/QstC60LAg0Y/QstC70Y/QtdGC0YHRjyDQsNCy0LDRgNC40LXQuSwg0LLRi9Cy0L7QtNC40Lwg0LTQsNC90LbQtdGAINC80LXRgdGB0LDQtNC2CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnNlcnZpY2VzW2ldLmRhbmdlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFsZXJ0TWVzc2FnZS5oYXNDbGFzcygnZWUtaGlkZGVuJykpIGFsZXJ0TWVzc2FnZS5yZW1vdmVDbGFzcygnZWUtaGlkZGVuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFsZXJ0TWVzc2FnZS5oYXNDbGFzcygnZWUtaGlkZGVuJykpIGFsZXJ0TWVzc2FnZS5hZGRDbGFzcygnZWUtaGlkZGVuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLy/QldGB0LvQuCDRgyDRgdC10YDQstC40YHQsCDQtdGB0YLRjCDRiNCw0LHQu9C+0L0sINC+0YLQv9GA0LDQstC70Y/QtdC8INC10LPQviDQvdCwINC40L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGOCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnNlcnZpY2VzW2ldLnRlbXBsYXRlICE9IHVuZGVmaW5lZCkgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlV3JhcHBlci5hcHBlbmQoIjxkaXYgY2xhc3M9J3Jvdyc+PGRpdiBjbGFzcz0nY29sIGwxMiBtMTIgczEyJz48c3Ryb25nIGNsYXNzPSdlZS1zdC1sYWJlbCc+0J/QvtC20LDQu9GD0LnRgdGC0LAsINGD0YLQvtGH0L3QuNGC0LUg0LjQvdGE0L7RgNC80LDRhtC40Y48L3N0cm9uZz48L2Rpdj48L2Rpdj4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGVtcGxhdGVXcmFwcGVyLmhhc0NsYXNzKCd0ZW1wbGF0ZS1leHQnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlV3JhcHBlci5hZGRDbGFzcygndGVtcGxhdGUtZXh0JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRUZW1wbGF0ZUxldmVsKHRlbXBsYXRlV3JhcHBlciwgZGF0YS5zZXJ2aWNlc1tpXS50ZW1wbGF0ZSwgZGF0YS5zZXJ2aWNlc1tpXS50ZW1wbGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLy9yZW5kZXJBcnRpY2xlcyhzZXJ2aWNlSWQpOwogICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZERlc2NyaXB0aW9uQ2hlY2soKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcHJvYmxlbVNlbGVjdG9yLnZhbChudWxsKS5zZWxlY3QyKHsKICAgICAgICAgICAgICAgIGNvbnRhaW5lckNzc0NsYXNzOiAnbWF0ZXJpYWxfbGlrZScsCiAgICAgICAgICAgICAgICB3aWR0aDogIjEwMCUiLAogICAgICAgICAgICAgICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IEluZmluaXR5LAogICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICfQktGL0LHQtdGA0LjRgtC1INGC0LjQvyDQv9GA0L7QsdC70LXQvNGLJwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIC8v0JXRgdC70Lgg0L/RgNC40YXQvtC00LjQvCDQstC80LXRgdGC0LUg0YEg0YHQtdGA0LLQuNGB0L7QvAogICAgICAgICAgICBpZiAocm91dGVyLmFyZ3MpewogICAgICAgICAgICAgICAgcHJvYmxlbVNlbGVjdG9yLnZhbChyb3V0ZXIuYXJnc1snc2VydmljZSddKTsKICAgICAgICAgICAgICAgIC8vcHJvYmxlbVNlbGVjdG9yLm1hdGVyaWFsX3NlbGVjdCgpOwogICAgICAgICAgICAgICAgcHJvYmxlbVNlbGVjdG9yLnRyaWdnZXIoJ2NoYW5nZScpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvKi8v0J/RgNC+0LLQtdGA0LrQsCDQvdCwINC00YPQsdC70LjQutCw0YLRiwogICAgICAgICAgICBmdW5jdGlvbiBjaGVja0R1cGxpY2F0ZXMoaWQpIHsKICAgICAgICAgICAgICAgIGlmIChpZCkgewogICAgICAgICAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJHRVQiLAogICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICJhcGkvc2VydmljZS8iICsgaWQgKyAiL3RpY2tldHMvP3N0YXRlPTAsMSwyLDMiCiAgICAgICAgICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbiAoZHVwbGljYXRlcykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGR1cGxpY2F0ZUFsZXJ0ID0gJCgiI2R1cGxpY2F0ZUFsZXJ0Iik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdXBsaWNhdGVzLm51bWJlck9mRWxlbWVudHMgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGR1cGxpY2F0ZUFsZXJ0Lmhhc0NsYXNzKCJlZS1oaWRkZW4iKSl7JGR1cGxpY2F0ZUFsZXJ0LnJlbW92ZUNsYXNzKCJlZS1oaWRkZW4iKX0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJGR1cGxpY2F0ZUFsZXJ0Lmhhc0NsYXNzKCJlZS1oaWRkZW4iKSl7JGR1cGxpY2F0ZUFsZXJ0LmFkZENsYXNzKCJlZS1oaWRkZW4iKX0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9Ki8KCiAgICAgICAgICAgIC8qZnVuY3Rpb24gcmVuZGVyQXJ0aWNsZXMoc2VydmljZUlkKSB7CiAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdHRVQnLAogICAgICAgICAgICAgICAgICAgIHVybDogJ2FwaS91c2VyL2FydGljbGUvP3NlcnZpY2VzPScgKyBzZXJ2aWNlSWQKICAgICAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24gKGFydGljbGVzKSB7CgogICAgICAgICAgICAgICAgICAgIHZhciAkYWRkVGlja2V0Q29sID0gJCgnI2FkZFRpY2tldENvbCcpLAogICAgICAgICAgICAgICAgICAgICAgICAkYXJ0aWNsZXNDb2wgPSAkKCcjYXJ0aWNsZXNDb2wnKTsKCiAgICAgICAgICAgICAgICAgICAgdmFyIGFydGljbGVXcmFwcGVyID0gJCgnI2FydGljbGVfd3JhcHBlcicpOwogICAgICAgICAgICAgICAgICAgIGFydGljbGVXcmFwcGVyLmVtcHR5KCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGFydGljbGVzICYmIGFydGljbGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFydGljbGVzTGlzdCA9ICI8ZGl2IGNsYXNzPSdhcnRpY2xlcy1jb2xsZWN0aW9uJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAkYWRkVGlja2V0Q29sLnJlbW92ZUNsYXNzKCdsMTIgbTEyIHMxMicpLmFkZENsYXNzKCdsOCBtOCBzMTInKTsKICAgICAgICAgICAgICAgICAgICAgICAgJGFydGljbGVzQ29sLnNob3coKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHdpbmRvdy5vdXRlcldpZHRoIDwgNDAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHRpY2tldE5hbWVCbG9jayA9ICQoJyN0aWNrZXROYW1lQmxvY2snKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aWNrZXROYW1lQmxvY2suYXBwZW5kKCc8YSBpZD0iYXJ0aWNsZXNBbmNob3IiPtCn0LjRgtCw0YLRjCDRgdGC0LDRgtGM0Lgg0L/QviDQstCw0YjQtdC5INC/0YDQvtCx0LvQtdC80LU8L2E+Jyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRhcnRpY2xlc0FuY2hvciA9ICQoJyNhcnRpY2xlc0FuY2hvcicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFydGljbGVzQW5jaG9yLnVuYmluZCgnY2xpY2snKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhcnRpY2xlc0FuY2hvci5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRhcnRpY2xlX3dyYXBwZXIgPSAkKCcjYXJ0aWNsZV93cmFwcGVyJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe3Njcm9sbFRvcDogJGFydGljbGVfd3JhcHBlci5vZmZzZXQoKS50b3B9LCAxMDAwKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICRhcnRpY2xlc0NvbC5yZW1vdmVDbGFzcygnYmxhbmstYXJ0aWNsZXMnKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGFydGljbGVzLmZvckVhY2goZnVuY3Rpb24gKGFydGljbGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFydGljbGVzTGlzdCArPSAiPGRpdiBjbGFzcz0nYXJ0aWNsZS1pdGVtJz48YSBjbGFzcz0nYXJ0aWNsZS1pdGVtLWhlYWRlcicgaHJlZj0nI2FydGljbGUvIiArIGFydGljbGUuaWQgKyAiLyc+IiArIGFydGljbGUuaGVhZGVyICsgIjxwIGNsYXNzPSdhcnRpY2xlLXByZXZpZXcnIHN0eWxlPSdtYXgtd2lkdGg6IGluaGVyaXQ7IG1hcmdpbi10b3A6IDE1cHgnPiIgKyBhcnRpY2xlLmh0bWwucmVwbGFjZSgvPFwvP1tePl0rPi9nLCcnKSArICI8L3A+PHAgY2xhc3M9J2FydGljbGUtcmVhZC1tb3JlJz7Qp9C40YLQsNGC0Ywg0LTQsNC70LXQtS4uLjxzcGFuIGNsYXNzPSdhcnRpY2xlLWl0ZW0tY291bnRlcic+PHNwYW4gc3R5bGU9J3ZlcnRpY2FsLWFsaWduOiBzdXBlcjsnPiIgKyBhcnRpY2xlLnZpZXdDb3VudCArICIgIiArICI8L3NwYW4+PGkgY2xhc3M9J21hdGVyaWFsLWljb25zJz52aXNpYmlsaXR5PC9pPjwvc3Bhbj48L3A+PC9hPjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBhcnRpY2xlc0xpc3QgKz0gIjwvZGl2PiI7CgogICAgICAgICAgICAgICAgICAgICAgICBhcnRpY2xlV3JhcHBlci5hcHBlbmQoYXJ0aWNsZXNMaXN0KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkbW9kdWxlID0gJCgiLmFydGljbGUtcHJldmlldyIpOwogICAgICAgICAgICAgICAgICAgICAgICAkbW9kdWxlLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2xhbXAoJG1vZHVsZVtpbmRleF0sIHtjbGFtcDogNX0pOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy9hcnRpY2xlV3JhcHBlci5hcHBlbmQoJzxoNj7QndC1INC90LDQudC00LXQvdC+INGB0YLQsNGC0LXQuSDQv9C+INC00LDQvdC90L7QuSDRgtC10LzQtS4uLjwvaDY+Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICRhZGRUaWNrZXRDb2wucmVtb3ZlQ2xhc3MoJ2w4IG04IHMxMicpLmFkZENsYXNzKCdsMTIgbTEyIHMxMicpOwogICAgICAgICAgICAgICAgICAgICAgICAkYXJ0aWNsZXNDb2wuaGlkZSgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FydGljbGVzQW5jaG9yJykucmVtb3ZlKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAkYXJ0aWNsZXNDb2wuYWRkQ2xhc3MoJ2JsYW5rLWFydGljbGVzJyk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9Ki8KCiAgICAgICAgICAgIGZ1bmN0aW9uIGluaXRUZW1wbGF0ZUxldmVsKHRlbXBsYXRlV3JhcHBlciwgbGV2ZWwsIHRlbXBsYXRlKSB7CiAgICAgICAgICAgICAgICB2YXIgcXVlc3Rpb24gPSBsZXZlbC5xdWVzdGlvbjsKICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvbikgewogICAgICAgICAgICAgICAgICAgIHZhciBhbnN3ZXJzID0gcXVlc3Rpb24uYW5zd2VyczsKICAgICAgICAgICAgICAgICAgICBpZiAoYW5zd2VycykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICI8b3B0aW9uIHZhbHVlPScnIGRpc2FibGVkIHNlbGVjdGVkPtCS0YvQsdC10YDQuNGC0LUg0LLQsNGA0LjQsNC90YI8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFuc3dlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgKz0gIjxvcHRpb24gZGF0YS1pbmRleD0nIiArIGkgKyAiJyB2YWx1ZT0nIiArIGFuc3dlcnNbaV0udmFsdWUgKyAiJz4iICsgYW5zd2Vyc1tpXS52YWx1ZSArICI8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxdWVzdGlvbkRPTSA9ICI8ZGl2IGlkPXRfcm93X3F1ZXN0aW9uXyIgKyBxdWVzdGlvbi5pZCArICIgY2xhc3M9J3Jvdyc+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPGRpdiBjbGFzcz0nY29sIGwxMiBzMTIgbTEyJz48cCBjbGFzcz0ndGVtcGxhdGUtcXVlc3Rpb24nIHN0eWxlPSdtYXJnaW46IDA7IGNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuODcpOyc+IiArIHF1ZXN0aW9uLm5hbWUgKyAocXVlc3Rpb24ucmVxdWlyZWQgPyAiPHNwYW4gc3R5bGU9J2NvbG9yOiByZWQ7Jz4gKjwvc3Bhbj4iIDogIiIpICsiPC9wPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxkaXYgY2xhc3M9J2lucHV0LWZpZWxkJz4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8c2VsZWN0IGNsYXNzPSd0X2NvbnRyb2wgYnJvd3Nlci1kZWZhdWx0ICIrIChxdWVzdGlvbi5yZXF1aXJlZCA/ICJyZXF1aXJlZCIgOiAiIikgKyAiJyAiICsgKHF1ZXN0aW9uLnRlbXBsYXRlID8gJ2RhdGEtdGVtcGxhdGUgPSAiJyArIHF1ZXN0aW9uLnRlbXBsYXRlICsgJyInIDogJ2RhdGEtbmFtZSA9ICInICsgZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXN0aW9uLm5hbWUpICsgJyInKSArICIgaWQ9dF9zZWxlY3RfcXVlc3Rpb25fIiArIHF1ZXN0aW9uLmlkICsgIj4iICsgb3B0aW9ucyArICI8L3NlbGVjdD4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVdyYXBwZXIuYXBwZW5kKHF1ZXN0aW9uRE9NKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRRdWVzdGlvbiA9ICQoIiN0X3NlbGVjdF9xdWVzdGlvbl8iICsgcXVlc3Rpb24uaWQpOwogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UXVlc3Rpb24ubWF0ZXJpYWxfc2VsZWN0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRRdWVzdGlvbi5jaGFuZ2UoZnVuY3Rpb24gKCkgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCEkKHRoaXMpLmhhc0NsYXNzKCdxdWVzdGlvbi12YWxpZCcpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdxdWVzdGlvbi12YWxpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vc2F2ZURyYWZ0VG9PYmplY3Qocm91dGVyKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcXVlc3Rpb25JZCA9IHF1ZXN0aW9uLmlkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFuc3dlciA9IGFuc3dlcnNbJCh0aGlzKS5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS5kYXRhKCJpbmRleCIpXTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2xkUXVlc3Rpb25zID0gJCgiI3Rfcm93X3F1ZXN0aW9uXyIgKyBxdWVzdGlvbklkKS5uZXh0QWxsKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuc3dlci5zZXJ2aWNlSWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlSWQgPSBhbnN3ZXIuc2VydmljZUlkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2xkUXVlc3Rpb25zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZUlkQ2FuZGlkYXRlID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hOZWFyU2VydmljZUlkKHF1ZXN0aW9uSWQsIHRlbXBsYXRlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlcnZpY2VJZENhbmRpZGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZUlkID0gc2VydmljZUlkQ2FuZGlkYXRlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZUlkID0gcm9vdFNlcnZpY2VJZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZFF1ZXN0aW9ucy5yZW1vdmUoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHNlcnZpY2VJZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0VGVtcGxhdGVMZXZlbCh0ZW1wbGF0ZVdyYXBwZXIsIGFuc3dlciwgdGVtcGxhdGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVSZXF1aXJlZENvdW50ZXIgPSAkKCcuZmlsZS1yZXF1aXJlZCcpLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZpbGVSZXF1aXJlZENvdW50ZXIgPiAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuYWpheC1maWxlLXVwbG9hZCcpLm5leHQoJ3NwYW4nKS5maW5kKCdzcGFuJykudGV4dCgn0JTQu9GPINGA0LXRiNC10L3QuNGPINC00LDQvdC90L7QuSDQv9GA0L7QsdC70LXQvNGLINC90LXQvtCx0YXQvtC00LjQvNC+INC/0YDQuNC70L7QttC40YLRjCDRhNCw0LnQu9GLJykuYXBwZW5kKCc8c3BhbiBzdHlsZT0iY29sb3I6IHJlZCI+ICo8L3NwYW4+Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5hamF4LWZpbGUtdXBsb2FkJykubmV4dCgnc3BhbicpLmZpbmQoJ3NwYW4nKS50ZXh0KCfQn9GA0LjQu9C+0LbQuNGC0LUg0YTQsNC50LvRiyDQtNC70Y8g0YHQutC+0YDQtdC50YjQtdCz0L4g0YDQtdGI0LXQvdC40Y8g0LLQsNGI0LXQuSDQv9GA0L7QsdC70LXQvNGLJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygiQmFkIHF1ZXN0aW9uIikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZHMgPSBsZXZlbC5maWVsZHM7CiAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkcyAmJiBmaWVsZHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBmaWVsZEdlbmVyYXRvcihmaWVsZHMsIHRlbXBsYXRlV3JhcHBlcik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNlYXJjaE5lYXJTZXJ2aWNlSWQocXVlc3Rpb25JZCwgdGVtcGxhdGUpIHsKCiAgICAgICAgICAgICAgICAgICAgdmFyIHF1ZXN0aW9uID0gdGVtcGxhdGUucXVlc3Rpb247CiAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uICYmIHF1ZXN0aW9uLmFuc3dlcnMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uLmlkID09IHF1ZXN0aW9uSWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VJZCA9IHNlcnZpY2VJZENhbmRpZGF0ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcXVlc3Rpb24uYW5zd2Vycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvbi5hbnN3ZXJzW2ldLnNlcnZpY2VJZCAmJiBxdWVzdGlvbi5hbnN3ZXJzW2ldLnF1ZXN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VJZENhbmRpZGF0ZSA9IHF1ZXN0aW9uLmFuc3dlcnNbaV0uc2VydmljZUlkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hOZWFyU2VydmljZUlkKHF1ZXN0aW9uLmFuc3dlcnNbaV0ucXVlc3Rpb24uaWQsIHF1ZXN0aW9uLmFuc3dlcnNbaV0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvL9Cf0L7QtNGB0LrQsNC30LrQsCDQvdCwINC60L3QvtC/0LrRgyDQvdC+0LLQvtCz0L4g0LrQvtC90YLQsNC60YLQsAogICAgICAgICAgICB2YXIgbmV3Q29udGFjdEJ0biA9ICQoIiNuZXdfY29udGFjdCIpOwogICAgICAgICAgICBuZXdDb250YWN0QnRuLnRvb2x0aXAoewogICAgICAgICAgICAgICAgZGVsYXk6IDUwLAogICAgICAgICAgICAgICAgdG9vbHRpcDogItCU0L7QsdCw0LLQuNGC0Ywg0L3QvtCy0YvQuSDQutC+0L3RgtCw0LrRgiDQv9GA0Lgg0YHQvtC30LTQsNC90LjQuCDQt9Cw0Y/QstC60LgiLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJib3R0b20iCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgbmV3Q29udGFjdENvbnRhaW5lciA9ICQoIiNuZXdfY29udGFjdF9jb250YWluZXIiKTsKICAgICAgICAgICAgdmFyIGNvbnRhY3RTZWxlY3RvciA9ICQoIiNjb250YWN0Iik7CgogICAgICAgICAgICAvL9Cd0LDQttCw0YLQuNC1INC60L3QvtC/0LrQuCDQvdC+0LLQvtCz0L4g0LrQvtC90YLQsNC60YLQsAogICAgICAgICAgICBuZXdDb250YWN0QnRuLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGlmIChuZXdDb250YWN0Q29udGFpbmVyLmhhc0NsYXNzKCJoaWRlIikpIHsKICAgICAgICAgICAgICAgICAgICBuZXdDb250YWN0Q29udGFpbmVyLnJlbW92ZUNsYXNzKCJoaWRlIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY29udGFjdFNlbGVjdG9yLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGNvbnRhY3RTZWxlY3Rvci52YWwoMCk7CiAgICAgICAgICAgICAgICAgICAgY29udGFjdFNlbGVjdG9yLm1hdGVyaWFsX3NlbGVjdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChjb250YWN0U2VsZWN0b3IubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBjb250YWN0U2VsZWN0b3IuY2hhbmdlKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIW5ld0NvbnRhY3RDb250YWluZXIuaGFzQ2xhc3MoImhpZGUiKSkgewogICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250YWN0Q29udGFpbmVyLmFkZENsYXNzKCJoaWRlIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8v0KDQsNCx0L7RgtCwINGBINC/0LvQsNCz0LjQvdC+0LwgRmlsZXVwbG9hZAogICAgICAgICAgICB2YXIgZmlsZUlkQXJyYXkgPSBbXTsKICAgICAgICAgICAgdmFyIG1heEZpbGVTaXplID0ge21heDoxMDQ4NTc2MCwgY3VycmVudDowfTsKICAgICAgICAgICAgJCgiI2ZpbGV1cGxvYWRlciIpLnVwbG9hZEZpbGUoewogICAgICAgICAgICAgICAgbWF4RmlsZUNvdW50OiA2LAogICAgICAgICAgICAgICAgbWF4RmlsZVNpemU6IDEwNDg1NzYwLAogICAgICAgICAgICAgICAgZHJhZ0Ryb3BTdHI6ICI8c3Bhbj48c3BhbiBzdHlsZT0nbWFyZ2luLWxlZnQ6IDE1cHg7Jz7Qn9GA0LjQu9C+0LbQuNGC0LUg0YTQsNC50LvRiyDQtNC70Y8g0YHQutC+0YDQtdC50YjQtdCz0L4g0YDQtdGI0LXQvdC40Y8g0LLQsNGI0LXQuSDQv9GA0L7QsdC70LXQvNGLPC9zcGFuPjwvc3Bhbj4iLAogICAgICAgICAgICAgICAgc2hvd0RlbGV0ZTogdHJ1ZSwKICAgICAgICAgICAgICAgIHVybDogImFwaS90aWNrZXQvZmlsZS8iLAogICAgICAgICAgICAgICAgZmlsZU5hbWU6ICJmaWxlcyIsCiAgICAgICAgICAgICAgICBzZXF1ZW50aWFsOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNlcXVlbnRpYWxDb3VudDogNiwKICAgICAgICAgICAgICAgIGVuY3R5cGU6ICJtdWx0aXBhcnQvZm9ybS1kYXRhIiwKICAgICAgICAgICAgICAgIGRlbGV0ZUNhbGxiYWNrOiBmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVOYW1lID0gdG9UcmFuc2xpdChvYmpbMF0ubmFtZSk7CiAgICAgICAgICAgICAgICAgICAgbWF4RmlsZVNpemUuY3VycmVudCAtPSBtYXhGaWxlU2l6ZVtmaWxlTmFtZV07CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG1heEZpbGVTaXplW2ZpbGVOYW1lXTsKICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG1heEZpbGVTaXplKTsKICAgICAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICdhcGkvdGlja2V0L2ZpbGUvJyArIG9ialswXS5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0RFTEVURScKICAgICAgICAgICAgICAgICAgICB9KS5hbHdheXMoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbGVJZEFycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqWzBdLmlkID09PSBmaWxlSWRBcnJheVtpXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVJZEFycmF5LnNwbGljZShpLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgb25TZWxlY3Q6ZnVuY3Rpb24gKGZpbGVzKSB7CiAgICAgICAgICAgICAgICAgICAgLy9kZWJ1Z2dlcjsKICAgICAgICAgICAgICAgICAgICB2YXIgdG90YWxTaXplID0gMDsKICAgICAgICAgICAgICAgICAgICAkLmVhY2goZmlsZXMsIGZ1bmN0aW9uIChpLCBmaWxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsU2l6ZSArPSBmaWxlLnNpemU7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgaWYobWF4RmlsZVNpemUuY3VycmVudCArIHRvdGFsU2l6ZSA+IG1heEZpbGVTaXplLm1heCl7CiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGVyaWFsaXplLnRvYXN0KCfQntCx0YnQuNC5INGA0LDQt9C80LXRgCDRhNCw0LnQu9C+0LIg0L3QtSDQtNC+0LvQttC10L0g0L/RgNC10LLRi9GI0LDRgtGMIDEwINCc0LXQs9Cw0LHQsNC50YInLCAzMDAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhtYXhGaWxlU2l6ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goZmlsZXMsIGZ1bmN0aW9uIChpLCBmaWxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhGaWxlU2l6ZVt0b1RyYW5zbGl0KGZpbGUubmFtZSldID0gZmlsZS5zaXplCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgbWF4RmlsZVNpemUuY3VycmVudCArPSB0b3RhbFNpemU7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cobWF4RmlsZVNpemUpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgb25TdWNjZXNzOmZ1bmN0aW9uKGZpbGVzLGRhdGEpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgTWF0ZXJpYWxpemUudG9hc3QoJ9Ck0LDQudC7INGD0YHQv9C10YjQvdC+INC00L7QsdCw0LLQu9C10L0nLCAzMDAwKTsKICAgICAgICAgICAgICAgICAgICBmaWxlSWRBcnJheS5wdXNoKGRhdGFbMF0uaWQpOwogICAgICAgICAgICAgICAgICAgICQoJy5hamF4LXVwbG9hZC1kcmFnZHJvcCcpLnJlbW92ZUNsYXNzKCdyZWQtZG90dGVkLWJvcmRlcicpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uKGZpbGVzLHN0YXR1cyxlcnJNc2cscGQpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgTWF0ZXJpYWxpemUudG9hc3QoJ9Ce0YjQuNCx0LrQsCAnLCAzMDAwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvL9Ch0LLQuNGC0YcsINCz0LXQvdC10YDQuNGA0YPRjtGJ0LjQuSDQv9C+0LvRjwogICAgICAgICAgICBmdW5jdGlvbiBmaWVsZEdlbmVyYXRvcihmaWVsZHMsIHRlbXBsYXRlV3JhcHBlcikgewogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlRm9ybSA9ICIiOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYW5zdyA9IGZpZWxkc1tpXS50ZW1wbGF0ZSA/ICdkYXRhLXRlbXBsYXRlID0gIicgKyBmaWVsZHNbaV0udGVtcGxhdGUgKyAnIicgOiAnZGF0YS1uYW1lID0gIicgKyBlbmNvZGVVUklDb21wb25lbnQoZmllbGRzW2ldLm5hbWUpICsgJyInOwogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZmllbGRzW2ldLnR5cGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiVEVYVCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZUZvcm0gKz0gIjxkaXYgaWQ9J3Rfcm93X2ZpZWxkXyIgKyBmaWVsZHNbaV0uaWQgKyAiJyBjbGFzcz0ncm93Jz4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICAgPGRpdiBjbGFzcz0nY29sIGwxMiBzMTIgbTEyJz48cCBjbGFzcz0ndGVtcGxhdGUtcXVlc3Rpb24nPiIgKyBmaWVsZHNbaV0ubmFtZSArIChmaWVsZHNbaV0ucmVxdWlyZWQgPyAiPHNwYW4gc3R5bGU9J2NvbG9yOiByZWQ7Jz4gKjwvc3Bhbj4iIDogIiIpICsiPC9wPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgICAgICAgPGlucHV0IGNsYXNzPSd0X2NvbnRyb2wgIiArIChmaWVsZHNbaV0ucmVxdWlyZWQgPyAicmVxdWlyZWQiIDogIiIpICsgIicgIiArIGFuc3cgKyAiIGlkPXRfdGV4dF8iICsgZmllbGRzW2ldLmlkICsgIiB0eXBlPSd0ZXh0Jz4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICAgPC9kaXY+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiU0VMRUNUIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gIjxvcHRpb24gdmFsdWU9JycgZGlzYWJsZWQgc2VsZWN0ZWQ+0JLRi9Cx0LXRgNC40YLQtSDQstCw0YDQuNCw0L3Rgjwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGZpZWxkc1tpXS52YWx1ZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zICs9ICI8b3B0aW9uIHZhbHVlPSciICsgZmllbGRzW2ldLnZhbHVlc1tqXSArICInPiIgKyBmaWVsZHNbaV0udmFsdWVzW2pdICsgIjwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZUZvcm0gKz0gIjxkaXYgaWQ9J3Rfcm93X2ZpZWxkXyIgKyBmaWVsZHNbaV0uaWQgKyAiJyBjbGFzcz0ncm93Jz4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPGRpdiBjbGFzcz0nY29sIGwxMiBzMTIgbTEyJz4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICAgPHAgY2xhc3M9J3RlbXBsYXRlLXF1ZXN0aW9uJz4iICsgZmllbGRzW2ldLm5hbWUgKyAoZmllbGRzW2ldLnJlcXVpcmVkID8gIjxzcGFuIHN0eWxlPSdjb2xvcjogcmVkOyc+ICo8L3NwYW4+IiA6ICIiKSArICI8L3A+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAgIDxkaXYgY2xhc3M9J2lucHV0LWZpZWxkJz4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICAgICAgIDxzZWxlY3QgY2xhc3M9J2Jyb3dzZXItZGVmYXVsdCB0X2NvbnRyb2wgIiArIChmaWVsZHNbaV0ucmVxdWlyZWQgPyAicmVxdWlyZWQiIDogIiIpICsgIicgIiArIGFuc3cgKyAiIGlkPXRfc2VsZWN0XyIgKyBmaWVsZHNbaV0uaWQgKyAiPiIgKyBvcHRpb25zICsgIjwvc2VsZWN0PiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgICA8L2Rpdj4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiTVVMVElfU0VMRUNUIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtdWx0aXBsZU9wdGlvbnMgPSAiPG9wdGlvbiB2YWx1ZT0nJyBkaXNhYmxlZCBzZWxlY3RlZD7QktGL0LHQtdGA0LjRgtC1INCy0LDRgNC40LDQvdGCPC9vcHRpb24+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHogPSAwOyB6IDwgZmllbGRzW2ldLnZhbHVlcy5sZW5ndGg7IHorKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG11bHRpcGxlT3B0aW9ucyArPSAiPG9wdGlvbiB2YWx1ZT0nIiArIHogKyAiJz4iICsgZmllbGRzW2ldLnZhbHVlc1t6XSArICI8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVGb3JtICs9ICI8ZGl2IGlkPSd0X3Jvd19maWVsZF8iICsgZmllbGRzW2ldLmlkICsgIicgY2xhc3M9J3Jvdyc+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxkaXYgY2xhc3M9J2NvbCBsMTIgczEyIG0xMic+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAgIDxwIGNsYXNzPSd0ZW1wbGF0ZS1xdWVzdGlvbic+IiArIGZpZWxkc1tpXS5uYW1lICsgKGZpZWxkc1tpXS5yZXF1aXJlZCA/ICI8c3BhbiBzdHlsZT0nY29sb3I6IHJlZDsnPiAqPC9zcGFuPiIgOiAiIikgKyAiPC9wPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgICA8ZGl2IGNsYXNzPSdpbnB1dC1maWVsZCc+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAgICAgICA8c2VsZWN0IG11bHRpcGxlIHN0eWxlPSdoZWlnaHQ6IDEwMHB4OycgY2xhc3M9J3RfY29udHJvbCAiICsgKGZpZWxkc1tpXS5yZXF1aXJlZCA/ICJyZXF1aXJlZCIgOiAiIikgKyAiJyAiICsgYW5zdyArICIgaWQ9dF9tdWx0aXBsZV8iICsgZmllbGRzW2ldLmlkICsgIj4iICsgbXVsdGlwbGVPcHRpb25zICsgIjwvc2VsZWN0PiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgICA8L2Rpdj4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICAgPC9kaXY+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiQ0hFQ0tCT1giOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVGb3JtICs9ICI8ZGl2IGlkPSd0X3Jvd19maWVsZF8iICsgZmllbGRzW2ldLmlkICsgIicgY2xhc3M9J3JvdyBjaGVja2JveC1yb3cnPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8ZGl2IGNsYXNzPSdpbnB1dC1maWVsZCBjb2wgbDEyIHMxMiBtMTInPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgICA8aW5wdXQgY2xhc3M9J3RfY29udHJvbCB0X2NoZWNrJyAiICsgYW5zdyArICIgdHlwZT0nY2hlY2tib3gnIGlkPXRfY2hlY2tfIiArIGZpZWxkc1tpXS5pZCArICI+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxsYWJlbCBzdHlsZT0nY29sb3I6IHJnYmEoMCwgMCwgMCwgMC44Nyk7JyBmb3I9J3RfY2hlY2tfIiArIGZpZWxkc1tpXS5pZCArICInPiIgKyBmaWVsZHNbaV0ubmFtZSArIChmaWVsZHNbaV0ucmVxdWlyZWQgPyAiPHNwYW4gc3R5bGU9J2NvbG9yOiByZWQ7Jz4gKjwvc3Bhbj4iIDogIiIpICsgIjwvbGFiZWw+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjwvZGl2PjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiREFURSI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZUZvcm0gKz0gIjxkaXYgaWQ9J3Rfcm93X2ZpZWxkXyIgKyBmaWVsZHNbaV0uaWQgKyAiJyBjbGFzcz0ncm93Jz4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPGRpdiBjbGFzcz0naW5wdXQtZmllbGQgY29sIGwxMiBzMTIgbTEyJz4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiICAgPHAgY2xhc3M9J3RlbXBsYXRlLXF1ZXN0aW9uJz4iICsgZmllbGRzW2ldLm5hbWUgKyAoZmllbGRzW2ldLnJlcXVpcmVkID8gIjxzcGFuIHN0eWxlPSdjb2xvcjogcmVkOyc+ICo8L3NwYW4+IiA6ICIiKSAgKyAiPC9wPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgICA8aW5wdXQgcGxhY2Vob2xkZXI9J9CS0YvQsdC10YDQuNGC0LUg0LTQsNGC0YMnIGNsYXNzPSd0X2NvbnRyb2wgZGF0ZXBpY2tlciAiICsgKGZpZWxkc1tpXS5yZXF1aXJlZCA/ICJyZXF1aXJlZCIgOiAiIikgKyAiJyAiICsgYW5zdyArICIgaWQ9dF9kYXRhXyIgKyBmaWVsZHNbaV0uaWQgKyAiIHR5cGU9J2RhdGUnPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPC9kaXY+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJEQVRFX1JBTkciOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVGb3JtICs9ICI8ZGl2IGlkPSd0X3Jvd19maWVsZF8iICsgZmllbGRzW2ldLmlkICsgIicgY2xhc3M9J3Jvdyc+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxkaXYgY2xhc3M9J2NvbCBsMTIgbTEyIHMxMic+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAgIDxwIGNsYXNzPSd0ZW1wbGF0ZS1xdWVzdGlvbic+IiArIGZpZWxkc1tpXS5uYW1lICsgKGZpZWxkc1tpXS5yZXF1aXJlZCA/ICI8c3BhbiBzdHlsZT0nY29sb3I6IHJlZDsnPiAqPC9zcGFuPiIgOiAiIikgICsgIjwvcD4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxkaXYgY2xhc3M9J2NvbCBsNiBtNiBzMTIgaW5wdXQtZmllbGQnPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgICA8cCBzdHlsZT0nbWFyZ2luOiAwOyBjb2xvcjogcmdiYSgwLCAwLCAwLCAwLjg3KTsnPtChPC9wPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgICA8aW5wdXQgZGF0YS1pZD0nIiArIGZpZWxkc1tpXS5pZCArICInIGNsYXNzPSd0X2RhdGFfcmFuZ2UgdF9jb250cm9sIGRhdGVwaWNrZXIgIiArIChmaWVsZHNbaV0ucmVxdWlyZWQgPyAicmVxdWlyZWQiIDogIiIpICsgIicgIiArIGFuc3cgKyAiIGlkPSd0X2RhdGFyYW5nZV9sZWZ0XyIgKyBmaWVsZHNbaV0uaWQgKyAiJyB0eXBlPSdkYXRlJz4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxkaXYgY2xhc3M9J2NvbCBsNiBtNiBzMTIgaW5wdXQtZmllbGQnPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgICA8cCBzdHlsZT0nbWFyZ2luOiAwOyBjb2xvcjogcmdiYSgwLCAwLCAwLCAwLjg3KTsnPtCf0L48L3A+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAgIDxpbnB1dCBkYXRhLWlkPSciICsgZmllbGRzW2ldLmlkICsgIicgY2xhc3M9J3RfZGF0YV9yYW5nZSB0X2NvbnRyb2wgZGF0ZXBpY2tlciAiICsgKGZpZWxkc1tpXS5yZXF1aXJlZCA/ICJyZXF1aXJlZCIgOiAiIikgKyAiJyAiICsgYW5zdyArICIgIGlkPSd0X2RhdGFyYW5nZV9yaWdodF8iICsgZmllbGRzW2ldLmlkICsgIicgdHlwZT0nZGF0ZSc+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgICA8ZGl2IGNsYXNzPSdkYXRhcmFuZ2VfZXJyb3IgZWUtaGlkZGVuIGNvbCBsMTIgczEyIG0xMic+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAgIDxwIHN0eWxlPSdjb2xvcjogcmVkOyBtYXJnaW46IDA7Jz7QlNCw0YLQsCDQvtC60L7QvdGH0LDQvdC40Y8g0L/RgNC+0LzQtdC20YPRgtC60LAg0L3QtSDQvNC+0LbQtdGCINCx0YvRgtGMINC80LXQvdGM0YjQtSDQtNCw0YLRiyDQtdCz0L4g0L3QsNGH0LDQu9CwITwvcD4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPC9kaXY+PC9kaXY+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJJTkZPIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlRm9ybSArPSAiPGRpdiBpZD0ndF9yb3dfZmllbGRfIiArIGZpZWxkc1tpXS5pZCArICInIGNsYXNzPSdyb3cnPjxkaXYgY2xhc3M9J2NvbCBsMTIgbTEyIHMxMic+PHAgY2xhc3M9J3RlbXBsYXRlLXF1ZXN0aW9uIiArIChmaWVsZHNbaV0ucmVxdWlyZWQgPyAiIGFsZXJ0LXRpY2tldC1tZXNzYWdlIGluZm8tcmVxdWlyZWQiIDogIiIpKyAgIic+IiArIGZpZWxkc1tpXS5uYW1lICsgIjwvcD48L2Rpdj48L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIkZJTEUiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVGb3JtICs9ICI8ZGl2IGlkPSd0X3Jvd19maWVsZF8iICsgZmllbGRzW2ldLmlkICsgIicgY2xhc3M9J3Jvdyc+PGRpdiBjbGFzcz0nY29sIGwxMiBtMTIgczEyJz48cCBjbGFzcz0ndGVtcGxhdGUtcXVlc3Rpb24gZmlsZS1yZXF1aXJlZCc+IiArIGZpZWxkc1tpXS5uYW1lICsgIjwvcD48L2Rpdj48L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGVtcGxhdGVXcmFwcGVyLmFwcGVuZCh0ZW1wbGF0ZUZvcm0pOwogICAgICAgICAgICAgICAgcmVxdWlyZWREZXNjcmlwdGlvbkNoZWNrKCk7CgogICAgICAgICAgICAgICAgdmFyICR0Q29udHJvbCA9ICQoJ2lucHV0LnRfY29udHJvbCcpOwogICAgICAgICAgICAgICAgJHRDb250cm9sLnVuYmluZCgnY2hhbmdlLnNwZWNpYWwnKTsKICAgICAgICAgICAgICAgICR0Q29udHJvbC5vbignY2hhbmdlLnNwZWNpYWwnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgLy9zYXZlRHJhZnRUb09iamVjdChyb3V0ZXIpOwogICAgICAgICAgICAgICAgICAgIGlmKCEkKHRoaXMpLmhhc0NsYXNzKCdxdWVzdGlvbi12YWxpZCcpICYmICQodGhpcykudmFsKCkgIT09ICIiKXsKICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygncXVlc3Rpb24tdmFsaWQnKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdxdWVzdGlvbi12YWxpZCcpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHZhciAkU3RDb250cm9sID0gJCgnc2VsZWN0LnRfY29udHJvbCcpOwogICAgICAgICAgICAgICAgJFN0Q29udHJvbC51bmJpbmQoJ2NoYW5nZS5zcGVjaWFsJyk7CiAgICAgICAgICAgICAgICAkU3RDb250cm9sLm9uKCdjaGFuZ2Uuc3BlY2lhbCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAvL3NhdmVEcmFmdFRvT2JqZWN0KHJvdXRlcik7CiAgICAgICAgICAgICAgICAgICAgaWYoJCh0aGlzKS5oYXNDbGFzcygncXVlc3Rpb24tdmFsaWQnKSAmJiAoJCh0aGlzKS52YWwoKSAhPT0gIiIgfHwgJCh0aGlzKS52YWwoKSAhPT0gW10pKXsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJCh0aGlzKS5oYXNDbGFzcygnaW5pdGlhbGl6ZWQnKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnByZXZBbGwoJ2lucHV0JykuYWRkQ2xhc3MoJ3F1ZXN0aW9uLXZhbGlkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdxdWVzdGlvbi12YWxpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJCh0aGlzKS5oYXNDbGFzcygnaW5pdGlhbGl6ZWQnKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnByZXZBbGwoJ2lucHV0JykucmVtb3ZlQ2xhc3MoJ3F1ZXN0aW9uLXZhbGlkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdxdWVzdGlvbi12YWxpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgdmFyIGZpbGVSZXF1aXJlZENvdW50ZXIgPSAkKCcuZmlsZS1yZXF1aXJlZCcpLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmKGZpbGVSZXF1aXJlZENvdW50ZXIgPiAwKXsKICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdUSU1FIFRPIFJFUVVJUkUgRklMRVMgQU1JR08gKEJST1dTRVIpJyk7CiAgICAgICAgICAgICAgICAgICAgJCgnLmFqYXgtZmlsZS11cGxvYWQnKS5uZXh0KCdzcGFuJykuZmluZCgnc3BhbicpLnRleHQoJ9CU0LvRjyDRgNC10YjQtdC90LjRjyDQtNCw0L3QvdC+0Lkg0L/RgNC+0LHQu9C10LzRiyDQvdC10L7QsdGF0L7QtNC40LzQviDQv9GA0LjQu9C+0LbQuNGC0Ywg0YTQsNC50LvRiycpLmFwcGVuZCgnPHNwYW4gc3R5bGU9ImNvbG9yOiByZWQiPiAqPC9zcGFuPicpOzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnLmFqYXgtZmlsZS11cGxvYWQnKS5uZXh0KCdzcGFuJykuZmluZCgnc3BhbicpLnRleHQoJ9Cf0YDQuNC70L7QttC40YLQtSDRhNCw0LnQu9GLINC00LvRjyDRgdC60L7RgNC10LnRiNC10LPQviDRgNC10YjQtdC90LjRjyDQstCw0YjQtdC5INC/0YDQvtCx0LvQtdC80YsnKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkKCcuZGF0ZXBpY2tlcicpLnBpY2thZGF0ZSh7CiAgICAgICAgICAgICAgICAgICAgc2VsZWN0TW9udGhzOiB0cnVlLCAvLyBDcmVhdGVzIGEgZHJvcGRvd24gdG8gY29udHJvbCBtb250aAogICAgICAgICAgICAgICAgICAgIHNlbGVjdFllYXJzOiAxNSAvLyBDcmVhdGVzIGEgZHJvcGRvd24gb2YgMTUgeWVhcnMgdG8gY29udHJvbCB5ZWFyLAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgJCgnLnRfZGF0YV9yYW5nZScpLmNoYW5nZShmdW5jdGlvbiAoKSB7CgogICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50RGF0YVJhbmdlSWQgPSAkKHRoaXMpLmRhdGEoJ2lkJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnREYXRhUmFuZ2UgPSAkKCcudF9kYXRhX3JhbmdlW2RhdGEtaWQ9JyArIGN1cnJlbnREYXRhUmFuZ2VJZCArICddJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGVQYXJ0cyA9IGN1cnJlbnREYXRhUmFuZ2VbMF0udmFsdWUuc3BsaXQoIi4iKTsKICAgICAgICAgICAgICAgICAgICB2YXIgZGF0ZU9iamVjdCA9IG5ldyBEYXRlKGRhdGVQYXJ0c1syXSwgZGF0ZVBhcnRzWzFdIC0gMSwgZGF0ZVBhcnRzWzBdKTsKICAgICAgICAgICAgICAgICAgICB2YXIgbGVmdFZhbHVlID0gZGF0ZU9iamVjdDsKICAgICAgICAgICAgICAgICAgICBkYXRlUGFydHMgPSBjdXJyZW50RGF0YVJhbmdlWzFdLnZhbHVlLnNwbGl0KCIuIik7CiAgICAgICAgICAgICAgICAgICAgZGF0ZU9iamVjdCA9IG5ldyBEYXRlKGRhdGVQYXJ0c1syXSwgZGF0ZVBhcnRzWzFdIC0gMSwgZGF0ZVBhcnRzWzBdKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcmlnaHRWYWx1ZSA9IGRhdGVPYmplY3Q7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJpZ2h0VmFsdWUgIT09ICIiICYmIGxlZnRWYWx1ZSAhPT0gIiIgJiYgKHJpZ2h0VmFsdWUgPCBsZWZ0VmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnREYXRhUmFuZ2UuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISQodGhpcykuaGFzQ2xhc3MoJ2ludmFsaWQnKSkgJCh0aGlzKS5hZGRDbGFzcygnaW52YWxpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlRXJyID0gJCgnLmRhdGFyYW5nZV9lcnJvcicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmdlRXJyLmhhc0NsYXNzKCdlZS1oaWRkZW4nKSkgcmFuZ2VFcnIucmVtb3ZlQ2xhc3MoJ2VlLWhpZGRlbicpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RGF0YVJhbmdlLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ2ludmFsaWQnKSkgJCh0aGlzKS5yZW1vdmVDbGFzcygnaW52YWxpZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlRXJyID0gJCgnLmRhdGFyYW5nZV9lcnJvcicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyYW5nZUVyci5oYXNDbGFzcygnZWUtaGlkZGVuJykpIHJhbmdlRXJyLmFkZENsYXNzKCdlZS1oaWRkZW4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgJCgnc2VsZWN0JykubWF0ZXJpYWxfc2VsZWN0KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8v0J7RgtC/0YDQsNCy0LvRj9C10Lwg0LfQsNGP0LLQutGDCiAgICAgICAgICAgICQoJyN0aWNrZXRfc2VuZCcpLnN1Ym1pdChmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICAgICAgdmFyICRtZXNzYWdlTW9kYWwgPSAkKCcjbWVzc2FnZU1vZGFsJyk7CgogICAgICAgICAgICAgICAgdmFyIHRoZW1lU2VsZWN0b3IgPSAkKCcjdGlja2V0X25hbWUnKSwKICAgICAgICAgICAgICAgICAgICBpbnZlbnRvcnlOdW0gPSAkKCcjaW52ZW50b3J5X251bScpLAogICAgICAgICAgICAgICAgICAgIGNvbnRhY3RNYWlsID0gJCgnI3Rhc2tfbWFpbCcpLAogICAgICAgICAgICAgICAgICAgIGNvbnRhY3RQaG9uZSA9ICQoJyN0YXNrX3Bob25lJyksCiAgICAgICAgICAgICAgICAgICAgY29udGFjdFNlbGVjdG9yID0gJCgiI2NvbnRhY3QiKSwKICAgICAgICAgICAgICAgICAgICB0aWNrZXREZXNjcmlwdGlvbiA9ICQoJyN0aWNrZXRfZGVzY3JpcHRpb24nKTsKCiAgICAgICAgICAgICAgICAvL9Ch0L7QsdC40YDQsNC10Lwg0LjQvdGE0L7RgNC80LDRhtC40Y4g0LjQtyDQv9C+0LvQtdC5INGI0LDQsdC70L7QvdCwCgogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlRmllbGRzID0gJCgnc2VsZWN0LnRfY29udHJvbCwgaW5wdXQudF9jb250cm9sJyk7CiAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVPdXRwdXQgPSBnZXRSZXN1bHRGcm9tRmllbGQodGVtcGxhdGVGaWVsZHMpOwoKICAgICAgICAgICAgICAgIGlmICh0ZW1wbGF0ZU91dHB1dCAmJiB0ZW1wbGF0ZU91dHB1dC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVPdXRwdXQgPSAodGlja2V0RGVzY3JpcHRpb24udmFsKCkgPT09ICIiID8gIiIgOiAiXG5cbiIpICsgdGVtcGxhdGVPdXRwdXQuam9pbigiXG4iKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB0ZW1wbGF0ZU91dHB1dCA9ICIiOwoKICAgICAgICAgICAgICAgIHZhciBpc0ZpbGVSZXF1aXJlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgdmFyIHRlc3RUZXh0ID0gJCgnLnRpY2tldC1icmVhYmNydW1icycpLnRleHQoKTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSByZXFpcmVkRmlsZUxpc3QubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAofnRlc3RUZXh0LmluZGV4T2YocmVxaXJlZEZpbGVMaXN0W2ldKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpc0ZpbGVSZXF1aXJlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoZm9ybVZhbGlkYXRpb24odGhlbWVTZWxlY3RvciwgY29udGFjdFNlbGVjdG9yLCBpbnZlbnRvcnlOdW0sIGNvbnRhY3RQaG9uZSwgdGlja2V0RGVzY3JpcHRpb24sIHRlbXBsYXRlRmllbGRzLCBmaWxlSWRBcnJheSwgaXNJbnZlbnRvcnksIGlzRmlsZVJlcXVpcmVkKSkgewoKICAgICAgICAgICAgICAgICAgICAkKCcjYWRkX3RpY2tldF9zZXQnKS5wcm9wKCdkaXNhYmxlZCcsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHZhciBwcm9ncmVzcyA9ICQoJyNuZXdfdGlja2V0X3Byb2dyZXNzJyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2dyZXNzLmhhc0NsYXNzKCdlZS1oaWRkZW4nKSkgcHJvZ3Jlc3MucmVtb3ZlQ2xhc3MoJ2VlLWhpZGRlbicpOwogICAgICAgICAgICAgICAgICAgIHZhciB0aWNrZXQgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRpY2tldERlc2NyaXB0aW9uLnZhbCgpICsgdGVtcGxhdGVPdXRwdXQsCiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogdGhlbWVTZWxlY3Rvci5jaGlsZHJlbignOnNlbGVjdGVkJykudGV4dCgpLAogICAgICAgICAgICAgICAgICAgICAgICB0aWNrZXRTdGF0ZUlkOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlSWQ6IHNlcnZpY2VJZCwKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXM6IGZpbGVJZEFycmF5LAogICAgICAgICAgICAgICAgICAgICAgICBpbnZlbnRvcnlOdW1iZXJJZDogaW52ZW50b3J5TnVtLnZhbCgpCiAgICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgICAgLy/QmNC90LLQtdC90YLQsNGA0L3QuNC6CiAgICAgICAgICAgICAgICAgICAgLyogdmFyICRpbnZlbnRhcnlTZWxlY3RvciA9ICQoIiNpbnZlbnRhcnlTZWxlY3RvciIpOwogICAgICAgICAgICAgICAgICAgIGlmICgkaW52ZW50YXJ5U2VsZWN0b3IudmFsKCkgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGlja2V0LmludmVudG9yeU51bWJlcklkID0gJGludmVudGFyeVNlbGVjdG9yLnZhbCgpOwogICAgICAgICAgICAgICAgICAgIH0gKi8KCiAgICAgICAgICAgICAgICAgICAgaWYgKHJvdXRlci5hcmdzWyJ1c2VyIl0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGlja2V0LnVzZXJJZCA9IHJvdXRlci5hcmdzWyJ1c2VyIl07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChjb250YWN0U2VsZWN0b3IubGVuZ3RoICYmIGNvbnRhY3RTZWxlY3Rvci52YWwoKSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aWNrZXQuY29udGFjdCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250YWN0U2VsZWN0b3IudmFsKCkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAvKnRpY2tldC5jb250YWN0ID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbE5hbWU6ICLQkNC70LXQutGB0LXQuSDQodC80YvRiNC70Y/QtdCyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiAiYS5zbXlzaGxpYWV2QGdtYWlsLmNvbSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaG9uZTogIis3IDk3NyA4MzMgNDQgODYiCiAgICAgICAgICAgICAgICAgICAgICAgIH07Ki8KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICdhcGkvdGlja2V0LycsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHRpY2tldCkKICAgICAgICAgICAgICAgICAgICB9KS5kb25lKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRtZXNzYWdlTW9kYWwuZmluZCgncCcpLmh0bWwoJ9Cd0L7QstGL0Lkg0LjQvdGG0LjQtNC10L3RgiBJTkNfJyArIGRhdGEuaWQgKycg0YPRgdC/0LXRiNC90L4g0YHQvtC30LTQsNC9PGJyPicgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ9Ce0YLQvNC10L3QsCDQstC+0LfQvNC+0LbQvdCwINCyINGC0LXRh9C10L3QuNC1IDEwINC80LjQvdGD0YIg0L/QvtGB0LvQtSDRgdC+0LfQtNCw0L3QuNGPINCyINGA0LDQt9C00LXQu9C1INC/0YDQvtGB0LzQvtGC0YDQsCAnICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBjbGFzcz0ibW9kYWwtYWN0aW9uIG1vZGFsLWNsb3NlIiBocmVmPSIvI3RpY2tldC8nICsgZGF0YS5pZCArICciPtC40L3RhtC40LTQtdC90YLQsDwvYT4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgJG1lc3NhZ2VNb2RhbC5maW5kKCdhJykubGFzdCgpLmF0dHIoJ2hyZWYnLCAnLycpOwogICAgICAgICAgICAgICAgICAgICAgICAkbWVzc2FnZU1vZGFsLm1vZGFsKCdvcGVuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5tb2RhbC1vdmVybGF5JykudW5iaW5kKCdjbGljaycpOwoKICAgICAgICAgICAgICAgICAgICAgICAgJC5yZW1vdmVDb29raWUoJ3RpY2tldC5kcmFmdC4nICsgcm91dGVyLnBhdGhbMV0pOwogICAgICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJvZ3Jlc3MuaGFzQ2xhc3MoJ2VlLWhpZGRlbicpKSBwcm9ncmVzcy5hZGRDbGFzcygnZWUtaGlkZGVuJyk7CgogICAgICAgICAgICAgICAgICAgICAgICAkbWVzc2FnZU1vZGFsLmZpbmQoJ3AnKS50ZXh0KGVycm9yLnJlc3BvbnNlSlNPTi5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgJG1lc3NhZ2VNb2RhbC5maW5kKCdhJykuYXR0cignaHJlZicsICcvJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICRtZXNzYWdlTW9kYWwubW9kYWwoJ29wZW4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF90aWNrZXRfc2V0JykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pCiAgICB9Cn0KCi8v0J/QvtC70L3QvtGG0LXQvdC90LDRjyDQstCw0LvQuNC00LDRhtC40Y8g0YTQvtGA0LzRiyDRgdC+0LfQtNCw0L3QuNGPINC30LDRj9Cy0LrQuApmdW5jdGlvbiBmb3JtVmFsaWRhdGlvbih0aGVtZVNlbGVjdG9yLCBjb250YWN0U2VsZWN0b3IsIGludmVudG9yeU51bSwgY29udGFjdFBob25lLCB0aWNrZXREZXNjcmlwdGlvbiwgdGVtcGxhdGVGaWVsZHMsIGZpbGVJZEFycmF5LCBpc0ludmVudG9yeSwgaXNGaWxlUmVxdWlyZWQpIHsKICAgIHZhciBmaWxlU2VsZWN0b3IgPSAkKCcjZmlsZXVwbG9hZGVyJykuZmluZCgnPiBkaXY6Zmlyc3QtY2hpbGQnKTsKICAgIHZhciAkbWVzc2FnZU1vZGFsID0gJCgnI21lc3NhZ2VNb2RhbCcpOwogICAgdmFyIGZpZWxkcyA9IFtdOwogICAgdmFyIGlzVmFsaWQgPSB0cnVlOwoKICAgIHZhciByZW1vdmVUaGVtZVNlbGVjdG9ySW52YWxpZENsYXNzSGFuZGxlciA9IGZ1bmN0aW9uKCl7dGhlbWVTZWxlY3Rvci5wYXJlbnQoKS5maW5kKCcubWF0ZXJpYWxfbGlrZScpLnRvZ2dsZUNsYXNzKCdpbnZhbGlkLXRleHRhcmVhJywgZmFsc2UpO307CiAgICB0aGVtZVNlbGVjdG9yLnVuYmluZCgnY2hhbmdlJywgcmVtb3ZlVGhlbWVTZWxlY3RvckludmFsaWRDbGFzc0hhbmRsZXIpOwogICAgdGhlbWVTZWxlY3Rvci5vbignY2hhbmdlJywgcmVtb3ZlVGhlbWVTZWxlY3RvckludmFsaWRDbGFzc0hhbmRsZXIpOwoKICAgIC8qdmFyIHJlbW92ZVRpY2tldERlc2NyaXB0aW9uSW52YWxpZENsYXNzSGFuZGxlciA9IGZ1bmN0aW9uKCkgewogICAgICAgIGlmICh0aWNrZXREZXNjcmlwdGlvbi5oYXNDbGFzcygnaW52YWxpZC10ZXh0YXJlYScpKSB0aWNrZXREZXNjcmlwdGlvbi5yZW1vdmVDbGFzcygnaW52YWxpZC10ZXh0YXJlYScpOwogICAgfTsKICAgIHRpY2tldERlc2NyaXB0aW9uLnVuYmluZCgnY2hhbmdlJyxyZW1vdmVUaWNrZXREZXNjcmlwdGlvbkludmFsaWRDbGFzc0hhbmRsZXIpOwogICAgdGlja2V0RGVzY3JpcHRpb24ub24oJ2NoYW5nZScsIHJlbW92ZVRpY2tldERlc2NyaXB0aW9uSW52YWxpZENsYXNzSGFuZGxlcik7Ki8KCiAgICB2YXIgcmVtb3ZlQ29udGFjdFNlbGVjdG9ySW52YWxpZENsYXNzSGFuZGxlciA9IGZ1bmN0aW9uKCl7Y29udGFjdFNlbGVjdG9yLnRvZ2dsZUNsYXNzKCdpbnZhbGlkLXRleHRhcmVhJywgZmFsc2UpO307CiAgICBjb250YWN0U2VsZWN0b3IudW5iaW5kKCdjaGFuZ2UnLCByZW1vdmVDb250YWN0U2VsZWN0b3JJbnZhbGlkQ2xhc3NIYW5kbGVyKTsKICAgIGNvbnRhY3RTZWxlY3Rvci5vbignY2hhbmdlJywgcmVtb3ZlQ29udGFjdFNlbGVjdG9ySW52YWxpZENsYXNzSGFuZGxlcik7CgogICAgdmFyIHJlbW92ZUNvbnRhY3ROYW1lSW52YWxpZENsYXNzSGFuZGxlciA9IGZ1bmN0aW9uKCl7aW52ZW50b3J5TnVtLnBhcmVudCgpLmZpbmQoJy5tYXRlcmlhbF9saWtlJykudG9nZ2xlQ2xhc3MoJ2ludmFsaWQtdGV4dGFyZWEnLCBmYWxzZSk7fTsKICAgIGludmVudG9yeU51bS51bmJpbmQoJ2NoYW5nZScscmVtb3ZlQ29udGFjdE5hbWVJbnZhbGlkQ2xhc3NIYW5kbGVyKTsKICAgIGludmVudG9yeU51bS5vbignY2hhbmdlJywgcmVtb3ZlQ29udGFjdE5hbWVJbnZhbGlkQ2xhc3NIYW5kbGVyKTsKCiAgICB2YXIgcmVtb3ZlQ29udGFjdFBob25lSW52YWxpZENsYXNzSGFuZGxlciA9IGZ1bmN0aW9uKCl7Y29udGFjdFBob25lLnRvZ2dsZUNsYXNzKCdpbnZhbGlkLXRleHRhcmVhJywgZmFsc2UpO307CiAgICBjb250YWN0UGhvbmUudW5iaW5kKCdjaGFuZ2UnLCByZW1vdmVDb250YWN0UGhvbmVJbnZhbGlkQ2xhc3NIYW5kbGVyKTsKICAgIGNvbnRhY3RQaG9uZS5vbignY2hhbmdlJywgcmVtb3ZlQ29udGFjdFBob25lSW52YWxpZENsYXNzSGFuZGxlcik7CgogICAgdmFyIHJlbW92ZUNvbnRhY3RQaG9uZUludmFsaWRDbGFzc0hhbmRsZXIgPSBmdW5jdGlvbigpe2NvbnRhY3RQaG9uZS50b2dnbGVDbGFzcygnaW52YWxpZC10ZXh0YXJlYScsIGZhbHNlKTt9OwogICAgY29udGFjdFBob25lLnVuYmluZCgnY2hhbmdlJywgcmVtb3ZlQ29udGFjdFBob25lSW52YWxpZENsYXNzSGFuZGxlcik7CiAgICBjb250YWN0UGhvbmUub24oJ2NoYW5nZScsIHJlbW92ZUNvbnRhY3RQaG9uZUludmFsaWRDbGFzc0hhbmRsZXIpOwoKICAgIHZhciByZW1vdmVGaWxlSW52YWxpZENsYXNzSGFuZGxlciA9IGZ1bmN0aW9uKCl7ZmlsZVNlbGVjdG9yLnRvZ2dsZUNsYXNzKCdpbnZhbGlkLXRleHRhcmVhJywgZmFsc2UpO307CiAgICBmaWxlU2VsZWN0b3IudW5iaW5kKCdjaGFuZ2UnLCByZW1vdmVGaWxlSW52YWxpZENsYXNzSGFuZGxlcik7CiAgICBmaWxlU2VsZWN0b3Iub24oJ2NoYW5nZScsIHJlbW92ZUZpbGVJbnZhbGlkQ2xhc3NIYW5kbGVyKTsKCiAgICBpZiAodGhlbWVTZWxlY3Rvci52YWwoKSA9PSBudWxsKSB7CiAgICAgICAgdGhlbWVTZWxlY3Rvci5wYXJlbnQoKS5maW5kKCcubWF0ZXJpYWxfbGlrZScpLnRvZ2dsZUNsYXNzKCdpbnZhbGlkLXRleHRhcmVhJywgdHJ1ZSk7CiAgICAgICAgaXNWYWxpZCA9IGZhbHNlOwogICAgICAgIGZpZWxkcy5wdXNoKCfRgtC10LzQsCcpOwogICAgfQogICAgaWYgKGlzSW52ZW50b3J5ICYmICFpbnZlbnRvcnlOdW0udmFsKCkpIHsKICAgICAgICBpc1ZhbGlkID0gZmFsc2U7CiAgICAgICAgZmllbGRzLnB1c2goJ9C40L3QstC10L3RgtCw0YDQvdGL0Lkg0L3QvtC80LXRgCcpOwogICAgICAgIGludmVudG9yeU51bS5wYXJlbnQoKS5maW5kKCcubWF0ZXJpYWxfbGlrZScpLnRvZ2dsZUNsYXNzKCdpbnZhbGlkLXRleHRhcmVhJywgdHJ1ZSk7CiAgICB9CiAgICBpZiAoaXNGaWxlUmVxdWlyZWQgJiYgKCFmaWxlSWRBcnJheSB8fCAhZmlsZUlkQXJyYXkubGVuZ3RoKSkgewogICAgICAgIGlzVmFsaWQgPSBmYWxzZTsKICAgICAgICBmaWVsZHMucHVzaCgn0YTQsNC50LsnKTsKICAgICAgICBmaWxlU2VsZWN0b3IudG9nZ2xlQ2xhc3MoJ2ludmFsaWQtdGV4dGFyZWEnLCB0cnVlKTsKICAgIH0KICAgIGlmICghaXNWYWxpZCkgewogICAgICAgIGlmIChmaWVsZHMubGVuZ3RoID4gMSkgewogICAgICAgICAgICAkbWVzc2FnZU1vZGFsLmZpbmQoJ3AnKS50ZXh0KCfQn9C+0LvRjyAnICsgZmllbGRzLmpvaW4oJywgJykgKyAnINC90LXQvtCx0YXQvtC00LjQvNGLINC00LvRjyDQt9Cw0L/QvtC70L3QtdC90LjRjycpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRtZXNzYWdlTW9kYWwuZmluZCgncCcpLnRleHQoJ9Cf0L7Qu9C1ICcgKyBmaWVsZHNbMF0gKyAnINC90LXQvtCx0YXQvtC00LjQvNC+INC00LvRjyDQt9Cw0L/QvtC70L3QtdC90LjRjycpOwogICAgICAgIH0KICAgICAgICAkbWVzc2FnZU1vZGFsLmZpbmQoJ2EnKS5yZW1vdmVBdHRyKCdocmVmJyk7CiAgICAgICAgJG1lc3NhZ2VNb2RhbC5tb2RhbCgnb3BlbicpOwogICAgfQogICAgcmV0dXJuIGlzVmFsaWQ7Cn0KCi8v0KHQvtCx0LjRgNCw0LXQvCDQuNC90YTQvtGA0LzQsNGG0LjRjiDRgSDRiNCw0LHQu9C+0L3QsCDQuCDQt9Cw0L/Rg9C70LjQstCw0LXQvCDQtdC1INCyIGRlc2NyaXB0aW9uCmZ1bmN0aW9uIGdldFJlc3VsdEZyb21GaWVsZCh0ZW1wbGF0ZUZpZWxkcykgewogICAgLy9jb25zb2xlLmxvZyh0ZW1wbGF0ZUZpZWxkcyk7CiAgICB2YXIgcmVzdWx0ID0gW107CiAgICB2YXIgcmFuZ2VWYWwgPSAiIiwgcmFuZ2VWYWxJdGVyYXRvciA9IDA7CiAgICB0ZW1wbGF0ZUZpZWxkcy5lYWNoKGZ1bmN0aW9uIChpbmRleCkgewogICAgICAgIHZhciBmaWVsZEFuc3dlciA9ICIiOwogICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCd0X2NoZWNrJykpIHsKICAgICAgICAgICAgaWYgKCQodGhpcykucHJvcCgnY2hlY2tlZCcpID09IHRydWUpIHsKICAgICAgICAgICAgICAgIGZpZWxkQW5zd2VyID0gJ9CU0LAnOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZmllbGRBbnN3ZXIgPSAn0J3QtdGCJzsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoJCh0aGlzKS5oYXNDbGFzcygndF9kYXRhX3JhbmdlJykpIHsKICAgICAgICAgICAgaWYoJCh0aGlzKS52YWwoKSAhPT0gIiIpewogICAgICAgICAgICAgICAgaWYgKHJhbmdlVmFsSXRlcmF0b3IgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIHJhbmdlVmFsICs9ICQodGhpcykudmFsKCk7CiAgICAgICAgICAgICAgICAgICAgcmFuZ2VWYWwgKz0gIuKAlCI7CiAgICAgICAgICAgICAgICAgICAgcmFuZ2VWYWxJdGVyYXRvciA9IDE7CgogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByYW5nZVZhbCArPSAkKHRoaXMpLnZhbCgpOwogICAgICAgICAgICAgICAgICAgIGZpZWxkQW5zd2VyID0gcmFuZ2VWYWw7CiAgICAgICAgICAgICAgICAgICAgcmFuZ2VWYWwgPSAiIjsKICAgICAgICAgICAgICAgICAgICByYW5nZVZhbEl0ZXJhdG9yID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGZpZWxkQW5zd2VyID0gbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZih0eXBlb2YgJCh0aGlzKS5hdHRyKCdtdWx0aXBsZScpICE9PSB0eXBlb2YgdW5kZWZpbmVkICYmIHR5cGVvZiAkKHRoaXMpLmF0dHIoJ211bHRpcGxlJykgIT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBmaWVsZEFuc3dlciA9IFtdOwogICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBpZighJCh0aGlzKS5pcygnOmRpc2FibGVkJykpewogICAgICAgICAgICAgICAgICAgICAgICBmaWVsZEFuc3dlci5wdXNoKCQodGhpcykudGV4dCgpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmKCFmaWVsZEFuc3dlci5sZW5ndGgpIGZpZWxkQW5zd2VyID0gbnVsbDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGZpZWxkQW5zd2VyID0gJCh0aGlzKS52YWwoKTsKICAgICAgICAgICAgfQoKICAgICAgICB9CiAgICAgICAgaWYgKHJhbmdlVmFsSXRlcmF0b3IgPT0gMCAmJiBmaWVsZEFuc3dlciAhPT0gbnVsbCAmJiBmaWVsZEFuc3dlciAhPT0gIiIpIHsKICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gJCh0aGlzKS5kYXRhKCJ0ZW1wbGF0ZSIpOwogICAgICAgICAgICBpZiAodGVtcGxhdGUpIHsKICAgICAgICAgICAgICAgIGlmICh0ZW1wbGF0ZSBpbnN0YW5jZW9mIE9iamVjdCkgewogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlID0gIiI7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlID0gIiIgKyB0ZW1wbGF0ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh0ZW1wbGF0ZS5pbmRleE9mKCJbXSIpICE9IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2godGVtcGxhdGUucmVwbGFjZSgiW10iLCBmaWVsZEFuc3dlcikpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh0ZW1wbGF0ZSArICIgLSAiICsgZmllbGRBbnN3ZXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goZGVjb2RlVVJJQ29tcG9uZW50KCQodGhpcykuZGF0YSgibmFtZSIpKSArICIgLSAiICsgZmllbGRBbnN3ZXIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdDsKfQoKZnVuY3Rpb24gcmVxdWlyZWREZXNjcmlwdGlvbkNoZWNrKCkgewogICAgdmFyICR2YXJpYWJsZVJlcXVpcmVtZW50ID0gJCgnI3ZhcmlhYmxlUmVxdWlyZW1lbnQnKTsKICAgIHZhciAkcmVxdWlyZWRUZW1wbGF0ZUZpZWxkcyA9ICQoJy5yZXF1aXJlZCcpOwogICAgaWYoJHJlcXVpcmVkVGVtcGxhdGVGaWVsZHMubGVuZ3RoID4gMCl7CiAgICAgICAgJHZhcmlhYmxlUmVxdWlyZW1lbnQuZW1wdHkoKTsKICAgICAgICBnbFZhbGlkYXRvciA9IGZhbHNlOwogICAgfSBlbHNlIHsKICAgICAgICAkdmFyaWFibGVSZXF1aXJlbWVudC5lbXB0eSgpLmFwcGVuZCgiKiIpOwogICAgICAgIGdsVmFsaWRhdG9yID0gdHJ1ZTsKICAgIH0KfQoKZnVuY3Rpb24gdG9UcmFuc2xpdCh0ZXh0KSB7CiAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC8oW9CwLdGP0ZFdKS9naSwKICAgICAgICBmdW5jdGlvbiAoYWxsLCBjaCwgaSkgewogICAgICAgICAgICB2YXIgY29kZSA9IGNoLmNoYXJDb2RlQXQoMCksCiAgICAgICAgICAgICAgICBpbmRleCA9IGNvZGUgPT0gMTAyNSB8fCBjb2RlID09IDExMDUgPyAwIDoKICAgICAgICAgICAgICAgICAgICBjb2RlID4gMTA3MSA/IGNvZGUgLSAxMDcxIDogY29kZSAtIDEwMzksCiAgICAgICAgICAgICAgICB0ID0gWyd5bycsICdhJywgJ2InLCAndicsICdnJywgJ2QnLCAnZScsICd6aCcsCiAgICAgICAgICAgICAgICAgICAgJ3onLCAnaScsICd5JywgJ2snLCAnbCcsICdtJywgJ24nLCAnbycsICdwJywKICAgICAgICAgICAgICAgICAgICAncicsICdzJywgJ3QnLCAndScsICdmJywgJ2gnLCAnYycsICdjaCcsICdzaCcsCiAgICAgICAgICAgICAgICAgICAgJ3NoY2gnLCAnJywgJ3knLCAnJywgJ2UnLCAneXUnLCAneWEnCiAgICAgICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gdFtpbmRleF07CiAgICAgICAgfSkKfQ==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="2968484" offset="0" length="1452" />
        <PacketInfo time="2968484" offset="1452" length="12548" />
        <PacketInfo time="2968515" offset="14000" length="1452" />
        <PacketInfo time="2968531" offset="15452" length="14520" />
        <PacketInfo time="2968531" offset="29972" length="1452" />
        <PacketInfo time="2968562" offset="31424" length="1452" />
        <PacketInfo time="2968562" offset="32876" length="16384" />
        <PacketInfo time="2968562" offset="49260" length="2492" />
        <PacketInfo time="2968593" offset="51752" length="1452" />
        <PacketInfo time="2968593" offset="53204" length="5367" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>